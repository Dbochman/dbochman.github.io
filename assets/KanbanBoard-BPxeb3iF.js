import{C as Rr,B as Qt,c as ue,f as G,w as Er,_ as pt,x as pe,y as kr}from"./index-C80gN8Bw.js";import{r as i,aW as W,as as Ze,j as s,aX as Ir,aY as Ln,K as Pn,aZ as Ar,aO as Et,aH as Or,aG as Tr,d as Mr,a_ as Lr,F as $n,a$ as Pr,b0 as $r,b1 as Fr,b2 as Br,b3 as zr,S as _r,b4 as kt,b5 as Ur,b6 as Kr,b7 as Fn,b8 as Xr,b9 as Zt,ba as Bn,bb as zn,bc as _n,bd as Un,be as Hr,t as Kn,ak as Vr,M as Yr,i as Xn,bf as Wr,a6 as Gr,bg as qr,bh as Jr,bi as Qr,bj as Zr,aN as es,N as ts}from"./vendor-DeyLhXpq.js";import{D as Hn,a as Vn,b as Yn,c as yt,d as ns}from"./dropdown-menu-DsCbc20s.js";import{I as ze}from"./input-YB48jCN_.js";import{T as Wn}from"./textarea-CN7b-HjI.js";import{L as ve}from"./label-zCgB-xLj.js";import{k as rs}from"./manifest-0AgvxBhP.js";import"./theme-CfHJhC9-.js";const ss=(e,t,n)=>{const r=e[t];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((o,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})};function os(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const It=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ve(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function on(e){return"nodeType"in e}function le(e){var t,n;return e?Ve(e)?e:on(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function an(e){const{Document:t}=le(e);return e instanceof t}function at(e){return Ve(e)?!1:e instanceof le(e).HTMLElement}function Gn(e){return e instanceof le(e).SVGElement}function Ye(e){return e?Ve(e)?e.document:on(e)?an(e)?e:at(e)||Gn(e)?e.ownerDocument:document:document:document}const Se=It?i.useLayoutEffect:i.useEffect;function At(e){const t=i.useRef(e);return Se(()=>{t.current=e}),i.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function as(){const e=i.useRef(null),t=i.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=i.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function rt(e,t){t===void 0&&(t=[e]);const n=i.useRef(e);return Se(()=>{n.current!==e&&(n.current=e)},t),n}function it(e,t){const n=i.useRef();return i.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function wt(e){const t=At(e),n=i.useRef(null),r=i.useCallback(o=>{o!==n.current&&t?.(o,n.current),n.current=o},[]);return[n,r]}function Ct(e){const t=i.useRef();return i.useEffect(()=>{t.current=e},[e]),t.current}let Ht={};function lt(e,t){return i.useMemo(()=>{if(t)return t;const n=Ht[e]==null?0:Ht[e]+1;return Ht[e]=n,e+"-"+n},[e,t])}function qn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((a,l)=>{const c=Object.entries(l);for(const[d,f]of c){const u=a[d];u!=null&&(a[d]=u+e*f)}return a},{...t})}}const He=qn(1),st=qn(-1);function is(e){return"clientX"in e&&"clientY"in e}function Ot(e){if(!e)return!1;const{KeyboardEvent:t}=le(e.target);return t&&e instanceof t}function ls(e){if(!e)return!1;const{TouchEvent:t}=le(e.target);return t&&e instanceof t}function St(e){if(ls(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return is(e)?{x:e.clientX,y:e.clientY}:null}const Pe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Pe.Translate.toString(e),Pe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),mn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function cs(e){return e.matches(mn)?e:e.querySelector(mn)}const ds={display:"none"};function us(e){let{id:t,value:n}=e;return W.createElement("div",{id:t,style:ds},n)}function fs(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return W.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function hs(){const[e,t]=i.useState("");return{announce:i.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Jn=i.createContext(null);function gs(e){const t=i.useContext(Jn);i.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function ms(){const[e]=i.useState(()=>new Set),t=i.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[i.useCallback(r=>{let{type:o,event:a}=r;e.forEach(l=>{var c;return(c=l[o])==null?void 0:c.call(l,a)})},[e]),t]}const ps={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},vs={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function bs(e){let{announcements:t=vs,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=ps}=e;const{announce:a,announcement:l}=hs(),c=lt("DndLiveRegion"),[d,f]=i.useState(!1);if(i.useEffect(()=>{f(!0)},[]),gs(i.useMemo(()=>({onDragStart(h){let{active:m}=h;a(t.onDragStart({active:m}))},onDragMove(h){let{active:m,over:g}=h;t.onDragMove&&a(t.onDragMove({active:m,over:g}))},onDragOver(h){let{active:m,over:g}=h;a(t.onDragOver({active:m,over:g}))},onDragEnd(h){let{active:m,over:g}=h;a(t.onDragEnd({active:m,over:g}))},onDragCancel(h){let{active:m,over:g}=h;a(t.onDragCancel({active:m,over:g}))}}),[a,t])),!d)return null;const u=W.createElement(W.Fragment,null,W.createElement(us,{id:r,value:o.draggable}),W.createElement(fs,{id:c,announcement:l}));return n?Ze.createPortal(u,n):u}var Q;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Q||(Q={}));function jt(){}function pn(e,t){return i.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function xs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const je=Object.freeze({x:0,y:0});function ys(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function ws(e,t){const n=St(e);if(!n)return"0 0";const r={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return r.x+"% "+r.y+"%"}function Cs(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Ss(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function vn(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function Qn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}const Zn=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=vn(t),a=[];for(const l of r){const{id:c}=l,d=n.get(c);if(d){const f=vn(d),u=o.reduce((m,g,y)=>m+ys(f[y],g),0),h=Number((u/4).toFixed(4));a.push({id:c,data:{droppableContainer:l,value:h}})}}return a.sort(Cs)};function js(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height),l=o-r,c=a-n;if(r<o&&n<a){const d=t.width*t.height,f=e.width*e.height,u=l*c,h=u/(d+f-u);return Number(h.toFixed(4))}return 0}const Ds=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const a of r){const{id:l}=a,c=n.get(l);if(c){const d=js(c,t);d>0&&o.push({id:l,data:{droppableContainer:a,value:d}})}}return o.sort(Ss)};function Ns(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function er(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:je}function Rs(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return o.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...n})}}const Es=Rs(1);function tr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function ks(e,t,n){const r=tr(t);if(!r)return e;const{scaleX:o,scaleY:a,x:l,y:c}=r,d=e.left-l-(1-o)*parseFloat(n),f=e.top-c-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),u=o?e.width/o:e.width,h=a?e.height/a:e.height;return{width:u,height:h,top:f,right:d+u,bottom:f+h,left:d}}const Is={ignoreTransform:!1};function We(e,t){t===void 0&&(t=Is);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:u}=le(e).getComputedStyle(e);f&&(n=ks(n,f,u))}const{top:r,left:o,width:a,height:l,bottom:c,right:d}=n;return{top:r,left:o,width:a,height:l,bottom:c,right:d}}function bn(e){return We(e,{ignoreTransform:!0})}function As(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Os(e,t){return t===void 0&&(t=le(e).getComputedStyle(e)),t.position==="fixed"}function Ts(e,t){t===void 0&&(t=le(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const a=t[o];return typeof a=="string"?n.test(a):!1})}function Tt(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(an(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!at(o)||Gn(o)||n.includes(o))return n;const a=le(e).getComputedStyle(o);return o!==e&&Ts(o,a)&&n.push(o),Os(o,a)?n:r(o.parentNode)}return e?r(e):n}function nr(e){const[t]=Tt(e,1);return t??null}function Vt(e){return!It||!e?null:Ve(e)?e:on(e)?an(e)||e===Ye(e).scrollingElement?window:at(e)?e:null:null}function rr(e){return Ve(e)?e.scrollX:e.scrollLeft}function sr(e){return Ve(e)?e.scrollY:e.scrollTop}function en(e){return{x:rr(e),y:sr(e)}}var Z;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Z||(Z={}));function or(e){return!It||!e?!1:e===document.scrollingElement}function ar(e){const t={x:0,y:0},n=or(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,a=e.scrollLeft<=t.x,l=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:o,isLeft:a,isBottom:l,isRight:c,maxScroll:r,minScroll:t}}const Ms={x:.2,y:.2};function Ls(e,t,n,r,o){let{top:a,left:l,right:c,bottom:d}=n;r===void 0&&(r=10),o===void 0&&(o=Ms);const{isTop:f,isBottom:u,isLeft:h,isRight:m}=ar(e),g={x:0,y:0},y={x:0,y:0},p={height:t.height*o.y,width:t.width*o.x};return!f&&a<=t.top+p.height?(g.y=Z.Backward,y.y=r*Math.abs((t.top+p.height-a)/p.height)):!u&&d>=t.bottom-p.height&&(g.y=Z.Forward,y.y=r*Math.abs((t.bottom-p.height-d)/p.height)),!m&&c>=t.right-p.width?(g.x=Z.Forward,y.x=r*Math.abs((t.right-p.width-c)/p.width)):!h&&l<=t.left+p.width&&(g.x=Z.Backward,y.x=r*Math.abs((t.left+p.width-l)/p.width)),{direction:g,speed:y}}function Ps(e){if(e===document.scrollingElement){const{innerWidth:a,innerHeight:l}=window;return{top:0,left:0,right:a,bottom:l,width:a,height:l}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function ir(e){return e.reduce((t,n)=>He(t,en(n)),je)}function $s(e){return e.reduce((t,n)=>t+rr(n),0)}function Fs(e){return e.reduce((t,n)=>t+sr(n),0)}function lr(e,t){if(t===void 0&&(t=We),!e)return;const{top:n,left:r,bottom:o,right:a}=t(e);nr(e)&&(o<=0||a<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Bs=[["x",["left","right"],$s],["y",["top","bottom"],Fs]];class ln{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Tt(n),o=ir(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[a,l,c]of Bs)for(const d of l)Object.defineProperty(this,d,{get:()=>{const f=c(r),u=o[a]-f;return this.rect[d]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class et{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function zs(e){const{EventTarget:t}=le(e);return e instanceof t?e:Ye(e)}function Yt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var be;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(be||(be={}));function xn(e){e.preventDefault()}function _s(e){e.stopPropagation()}var L;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(L||(L={}));const cr={start:[L.Space,L.Enter],cancel:[L.Esc],end:[L.Space,L.Enter,L.Tab]},Us=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case L.Right:return{...n,x:n.x+25};case L.Left:return{...n,x:n.x-25};case L.Down:return{...n,y:n.y+25};case L.Up:return{...n,y:n.y-25}}};class cn{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new et(Ye(n)),this.windowListeners=new et(le(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(be.Resize,this.handleCancel),this.windowListeners.add(be.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(be.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&lr(r),n(je)}handleKeyDown(t){if(Ot(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:a=cr,coordinateGetter:l=Us,scrollBehavior:c="smooth"}=o,{code:d}=t;if(a.end.includes(d)){this.handleEnd(t);return}if(a.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:f}=r.current,u=f?{x:f.left,y:f.top}:je;this.referenceCoordinates||(this.referenceCoordinates=u);const h=l(t,{active:n,context:r.current,currentCoordinates:u});if(h){const m=st(h,u),g={x:0,y:0},{scrollableAncestors:y}=r.current;for(const p of y){const v=t.code,{isTop:S,isRight:N,isLeft:x,isBottom:D,maxScroll:R,minScroll:O}=ar(p),E=Ps(p),A={x:Math.min(v===L.Right?E.right-E.width/2:E.right,Math.max(v===L.Right?E.left:E.left+E.width/2,h.x)),y:Math.min(v===L.Down?E.bottom-E.height/2:E.bottom,Math.max(v===L.Down?E.top:E.top+E.height/2,h.y))},_=v===L.Right&&!N||v===L.Left&&!x,X=v===L.Down&&!D||v===L.Up&&!S;if(_&&A.x!==h.x){const $=p.scrollLeft+m.x,te=v===L.Right&&$<=R.x||v===L.Left&&$>=O.x;if(te&&!m.y){p.scrollTo({left:$,behavior:c});return}te?g.x=p.scrollLeft-$:g.x=v===L.Right?p.scrollLeft-R.x:p.scrollLeft-O.x,g.x&&p.scrollBy({left:-g.x,behavior:c});break}else if(X&&A.y!==h.y){const $=p.scrollTop+m.y,te=v===L.Down&&$<=R.y||v===L.Up&&$>=O.y;if(te&&!m.x){p.scrollTo({top:$,behavior:c});return}te?g.y=p.scrollTop-$:g.y=v===L.Down?p.scrollTop-R.y:p.scrollTop-O.y,g.y&&p.scrollBy({top:-g.y,behavior:c});break}}this.handleMove(t,He(st(h,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}cn.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=cr,onActivation:o}=t,{active:a}=n;const{code:l}=e.nativeEvent;if(r.start.includes(l)){const c=a.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),o?.({event:e.nativeEvent}),!0)}return!1}}];function yn(e){return!!(e&&"distance"in e)}function wn(e){return!!(e&&"delay"in e)}class dn{constructor(t,n,r){var o;r===void 0&&(r=zs(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:a}=t,{target:l}=a;this.props=t,this.events=n,this.document=Ye(l),this.documentListeners=new et(this.document),this.listeners=new et(r),this.windowListeners=new et(le(l)),this.initialCoordinates=(o=St(a))!=null?o:je,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(be.Resize,this.handleCancel),this.windowListeners.add(be.DragStart,xn),this.windowListeners.add(be.VisibilityChange,this.handleCancel),this.windowListeners.add(be.ContextMenu,xn),this.documentListeners.add(be.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(wn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(yn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(be.Click,_s,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(be.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:a}=this,{onMove:l,options:{activationConstraint:c}}=a;if(!o)return;const d=(n=St(t))!=null?n:je,f=st(o,d);if(!r&&c){if(yn(c)){if(c.tolerance!=null&&Yt(f,c.tolerance))return this.handleCancel();if(Yt(f,c.distance))return this.handleStart()}if(wn(c)&&Yt(f,c.tolerance))return this.handleCancel();this.handlePending(c,f);return}t.cancelable&&t.preventDefault(),l(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===L.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Ks={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class un extends dn{constructor(t){const{event:n}=t,r=Ye(n.target);super(t,Ks,r)}}un.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const Xs={move:{name:"mousemove"},end:{name:"mouseup"}};var tn;(function(e){e[e.RightClick=2]="RightClick"})(tn||(tn={}));class Hs extends dn{constructor(t){super(t,Xs,Ye(t.event.target))}}Hs.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===tn.RightClick?!1:(r?.({event:n}),!0)}}];const Wt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Vs extends dn{constructor(t){super(t,Wt)}static setup(){return window.addEventListener(Wt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Wt.move.name,t)};function t(){}}}Vs.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r?.({event:n}),!0)}}];var tt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(tt||(tt={}));var Dt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Dt||(Dt={}));function Ys(e){let{acceleration:t,activator:n=tt.Pointer,canScroll:r,draggingRect:o,enabled:a,interval:l=5,order:c=Dt.TreeOrder,pointerCoordinates:d,scrollableAncestors:f,scrollableAncestorRects:u,delta:h,threshold:m}=e;const g=Gs({delta:h,disabled:!a}),[y,p]=as(),v=i.useRef({x:0,y:0}),S=i.useRef({x:0,y:0}),N=i.useMemo(()=>{switch(n){case tt.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case tt.DraggableRect:return o}},[n,o,d]),x=i.useRef(null),D=i.useCallback(()=>{const O=x.current;if(!O)return;const E=v.current.x*S.current.x,A=v.current.y*S.current.y;O.scrollBy(E,A)},[]),R=i.useMemo(()=>c===Dt.TreeOrder?[...f].reverse():f,[c,f]);i.useEffect(()=>{if(!a||!f.length||!N){p();return}for(const O of R){if(r?.(O)===!1)continue;const E=f.indexOf(O),A=u[E];if(!A)continue;const{direction:_,speed:X}=Ls(O,A,N,t,m);for(const $ of["x","y"])g[$][_[$]]||(X[$]=0,_[$]=0);if(X.x>0||X.y>0){p(),x.current=O,y(D,l),v.current=X,S.current=_;return}}v.current={x:0,y:0},S.current={x:0,y:0},p()},[t,D,r,p,a,l,JSON.stringify(N),JSON.stringify(g),y,f,R,u,JSON.stringify(m)])}const Ws={x:{[Z.Backward]:!1,[Z.Forward]:!1},y:{[Z.Backward]:!1,[Z.Forward]:!1}};function Gs(e){let{delta:t,disabled:n}=e;const r=Ct(t);return it(o=>{if(n||!r||!o)return Ws;const a={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[Z.Backward]:o.x[Z.Backward]||a.x===-1,[Z.Forward]:o.x[Z.Forward]||a.x===1},y:{[Z.Backward]:o.y[Z.Backward]||a.y===-1,[Z.Forward]:o.y[Z.Forward]||a.y===1}}},[n,t,r])}function qs(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return it(o=>{var a;return t==null?null:(a=r??o)!=null?a:null},[r,t])}function Js(e,t){return i.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,a=o.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,r)}));return[...n,...a]},[]),[e,t])}var ot;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(ot||(ot={}));var nn;(function(e){e.Optimized="optimized"})(nn||(nn={}));const Cn=new Map;function Qs(e,t){let{dragging:n,dependencies:r,config:o}=t;const[a,l]=i.useState(null),{frequency:c,measure:d,strategy:f}=o,u=i.useRef(e),h=v(),m=rt(h),g=i.useCallback(function(S){S===void 0&&(S=[]),!m.current&&l(N=>N===null?S:N.concat(S.filter(x=>!N.includes(x))))},[m]),y=i.useRef(null),p=it(S=>{if(h&&!n)return Cn;if(!S||S===Cn||u.current!==e||a!=null){const N=new Map;for(let x of e){if(!x)continue;if(a&&a.length>0&&!a.includes(x.id)&&x.rect.current){N.set(x.id,x.rect.current);continue}const D=x.node.current,R=D?new ln(d(D),D):null;x.rect.current=R,R&&N.set(x.id,R)}return N}return S},[e,a,n,h,d]);return i.useEffect(()=>{u.current=e},[e]),i.useEffect(()=>{h||g()},[n,h]),i.useEffect(()=>{a&&a.length>0&&l(null)},[JSON.stringify(a)]),i.useEffect(()=>{h||typeof c!="number"||y.current!==null||(y.current=setTimeout(()=>{g(),y.current=null},c))},[c,h,g,...r]),{droppableRects:p,measureDroppableContainers:g,measuringScheduled:a!=null};function v(){switch(f){case ot.Always:return!1;case ot.BeforeDragging:return n;default:return!n}}}function fn(e,t){return it(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Zs(e,t){return fn(e,t)}function eo(e){let{callback:t,disabled:n}=e;const r=At(t),o=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(r)},[r,n]);return i.useEffect(()=>()=>o?.disconnect(),[o]),o}function Mt(e){let{callback:t,disabled:n}=e;const r=At(t),o=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(r)},[n]);return i.useEffect(()=>()=>o?.disconnect(),[o]),o}function to(e){return new ln(We(e),e)}function Sn(e,t,n){t===void 0&&(t=to);const[r,o]=i.useState(null);function a(){o(d=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=d??n)!=null?f:null}const u=t(e);return JSON.stringify(d)===JSON.stringify(u)?d:u})}const l=eo({callback(d){if(e)for(const f of d){const{type:u,target:h}=f;if(u==="childList"&&h instanceof HTMLElement&&h.contains(e)){a();break}}}}),c=Mt({callback:a});return Se(()=>{a(),e?(c?.observe(e),l?.observe(document.body,{childList:!0,subtree:!0})):(c?.disconnect(),l?.disconnect())},[e]),r}function no(e){const t=fn(e);return er(e,t)}const jn=[];function ro(e){const t=i.useRef(e),n=it(r=>e?r&&r!==jn&&e&&t.current&&e.parentNode===t.current.parentNode?r:Tt(e):jn,[e]);return i.useEffect(()=>{t.current=e},[e]),n}function so(e){const[t,n]=i.useState(null),r=i.useRef(e),o=i.useCallback(a=>{const l=Vt(a.target);l&&n(c=>c?(c.set(l,en(l)),new Map(c)):null)},[]);return i.useEffect(()=>{const a=r.current;if(e!==a){l(a);const c=e.map(d=>{const f=Vt(d);return f?(f.addEventListener("scroll",o,{passive:!0}),[f,en(f)]):null}).filter(d=>d!=null);n(c.length?new Map(c):null),r.current=e}return()=>{l(e),l(a)};function l(c){c.forEach(d=>{const f=Vt(d);f?.removeEventListener("scroll",o)})}},[o,e]),i.useMemo(()=>e.length?t?Array.from(t.values()).reduce((a,l)=>He(a,l),je):ir(e):je,[e,t])}function Dn(e,t){t===void 0&&(t=[]);const n=i.useRef(null);return i.useEffect(()=>{n.current=null},t),i.useEffect(()=>{const r=e!==je;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?st(e,n.current):je}function oo(e){i.useEffect(()=>{if(!It)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function ao(e,t){return i.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:a}=r;return n[o]=l=>{a(l,t)},n},{}),[e,t])}function dr(e){return i.useMemo(()=>e?As(e):null,[e])}const Nn=[];function io(e,t){t===void 0&&(t=We);const[n]=e,r=dr(n?le(n):null),[o,a]=i.useState(Nn);function l(){a(()=>e.length?e.map(d=>or(d)?r:new ln(t(d),d)):Nn)}const c=Mt({callback:l});return Se(()=>{c?.disconnect(),l(),e.forEach(d=>c?.observe(d))},[e]),o}function ur(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return at(t)?t:e}function lo(e){let{measure:t}=e;const[n,r]=i.useState(null),o=i.useCallback(f=>{for(const{target:u}of f)if(at(u)){r(h=>{const m=t(u);return h?{...h,width:m.width,height:m.height}:m});break}},[t]),a=Mt({callback:o}),l=i.useCallback(f=>{const u=ur(f);a?.disconnect(),u&&a?.observe(u),r(u?t(u):null)},[t,a]),[c,d]=wt(l);return i.useMemo(()=>({nodeRef:c,rect:n,setRef:d}),[n,c,d])}const co=[{sensor:un,options:{}},{sensor:cn,options:{}}],uo={current:{}},xt={draggable:{measure:bn},droppable:{measure:bn,strategy:ot.WhileDragging,frequency:nn.Optimized},dragOverlay:{measure:We}};class nt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const fo={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new nt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:jt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:xt,measureDroppableContainers:jt,windowRect:null,measuringScheduled:!1},fr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:jt,draggableNodes:new Map,over:null,measureDroppableContainers:jt},ct=i.createContext(fr),hr=i.createContext(fo);function ho(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new nt}}}function go(e,t){switch(t.type){case Q.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Q.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Q.DragEnd:case Q.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Q.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new nt(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case Q.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,a=e.droppable.containers.get(n);if(!a||r!==a.key)return e;const l=new nt(e.droppable.containers);return l.set(n,{...a,disabled:o}),{...e,droppable:{...e.droppable,containers:l}}}case Q.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const a=new nt(e.droppable.containers);return a.delete(n),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function mo(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=i.useContext(ct),a=Ct(r),l=Ct(n?.id);return i.useEffect(()=>{if(!t&&!r&&a&&l!=null){if(!Ot(a)||document.activeElement===a.target)return;const c=o.get(l);if(!c)return;const{activatorNode:d,node:f}=c;if(!d.current&&!f.current)return;requestAnimationFrame(()=>{for(const u of[d.current,f.current]){if(!u)continue;const h=cs(u);if(h){h.focus();break}}})}},[r,t,o,l,a]),null}function gr(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,a)=>a({transform:o,...r}),n):n}function po(e){return i.useMemo(()=>({draggable:{...xt.draggable,...e?.draggable},droppable:{...xt.droppable,...e?.droppable},dragOverlay:{...xt.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function vo(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const a=i.useRef(!1),{x:l,y:c}=typeof o=="boolean"?{x:o,y:o}:o;Se(()=>{if(!l&&!c||!t){a.current=!1;return}if(a.current||!r)return;const f=t?.node.current;if(!f||f.isConnected===!1)return;const u=n(f),h=er(u,r);if(l||(h.x=0),c||(h.y=0),a.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const m=nr(f);m&&m.scrollBy({top:h.y,left:h.x})}},[t,l,c,r,n])}const Lt=i.createContext({...je,scaleX:1,scaleY:1});var Le;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Le||(Le={}));const bo=i.memo(function(t){var n,r,o,a;let{id:l,accessibility:c,autoScroll:d=!0,children:f,sensors:u=co,collisionDetection:h=Ds,measuring:m,modifiers:g,...y}=t;const p=i.useReducer(go,void 0,ho),[v,S]=p,[N,x]=ms(),[D,R]=i.useState(Le.Uninitialized),O=D===Le.Initialized,{draggable:{active:E,nodes:A,translate:_},droppable:{containers:X}}=v,$=E!=null?A.get(E):null,te=i.useRef({initial:null,translated:null}),ne=i.useMemo(()=>{var T;return E!=null?{id:E,data:(T=$?.data)!=null?T:uo,rect:te}:null},[E,$]),re=i.useRef(null),[De,w]=i.useState(null),[M,fe]=i.useState(null),ce=rt(y,Object.values(y)),he=lt("DndDescribedBy",l),ke=i.useMemo(()=>X.getEnabled(),[X]),ee=po(m),{droppableRects:de,measureDroppableContainers:xe,measuringScheduled:$e}=Qs(ke,{dragging:O,dependencies:[_.x,_.y],config:ee.droppable}),se=qs(A,E),_e=i.useMemo(()=>M?St(M):null,[M]),ye=z(),we=Zs(se,ee.draggable.measure);vo({activeNode:E!=null?A.get(E):null,config:ye.layoutShiftCompensation,initialRect:we,measure:ee.draggable.measure});const F=Sn(se,ee.draggable.measure,we),Ce=Sn(se?se.parentElement:null),ge=i.useRef({activatorEvent:null,active:null,activeNode:se,collisionRect:null,collisions:null,droppableRects:de,draggableNodes:A,draggingNode:null,draggingNodeRect:null,droppableContainers:X,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ie=X.getNodeFor((n=ge.current.over)==null?void 0:n.id),oe=lo({measure:ee.dragOverlay.measure}),Ne=(r=oe.nodeRef.current)!=null?r:se,Ae=O?(o=oe.rect)!=null?o:F:null,dt=!!(oe.nodeRef.current&&oe.rect),ut=no(dt?null:F),Ge=dr(Ne?le(Ne):null),Re=ro(O?Ie??se:null),Ue=io(Re),Ke=gr(g,{transform:{x:_.x-ut.x,y:_.y-ut.y,scaleX:1,scaleY:1},activatorEvent:M,active:ne,activeNodeRect:F,containerNodeRect:Ce,draggingNodeRect:Ae,over:ge.current.over,overlayNodeRect:oe.rect,scrollableAncestors:Re,scrollableAncestorRects:Ue,windowRect:Ge}),ft=_e?He(_e,_):null,ht=so(Re),_t=Dn(ht),Ut=Dn(ht,[F]),Oe=He(Ke,_t),Te=Ae?Es(Ae,Ke):null,Fe=ne&&Te?h({active:ne,collisionRect:Te,droppableRects:de,droppableContainers:ke,pointerCoordinates:ft}):null,qe=Qn(Fe,"id"),[Ee,gt]=i.useState(null),Kt=dt?Ke:He(Ke,Ut),mt=Ns(Kt,(a=Ee?.rect)!=null?a:null,F),Je=i.useRef(null),b=i.useCallback((T,P)=>{let{sensor:B,options:ae}=P;if(re.current==null)return;const q=A.get(re.current);if(!q)return;const J=T.nativeEvent,ie=new B({active:re.current,activeNode:q,event:J,options:ae,context:ge,onAbort(H){if(!A.get(H))return;const{onDragAbort:I}=ce.current,V={id:H};I?.(V),N({type:"onDragAbort",event:V})},onPending(H,me,I,V){if(!A.get(H))return;const{onDragPending:Be}=ce.current,Me={id:H,constraint:me,initialCoordinates:I,offset:V};Be?.(Me),N({type:"onDragPending",event:Me})},onStart(H){const me=re.current;if(me==null)return;const I=A.get(me);if(!I)return;const{onDragStart:V}=ce.current,Y={activatorEvent:J,active:{id:me,data:I.data,rect:te}};Ze.unstable_batchedUpdates(()=>{V?.(Y),R(Le.Initializing),S({type:Q.DragStart,initialCoordinates:H,active:me}),N({type:"onDragStart",event:Y}),w(Je.current),fe(J)})},onMove(H){S({type:Q.DragMove,coordinates:H})},onEnd:K(Q.DragEnd),onCancel:K(Q.DragCancel)});Je.current=ie;function K(H){return async function(){const{active:I,collisions:V,over:Y,scrollAdjustedTranslate:Be}=ge.current;let Me=null;if(I&&Be){const{cancelDrop:Qe}=ce.current;Me={activatorEvent:J,active:I,collisions:V,delta:Be,over:Y},H===Q.DragEnd&&typeof Qe=="function"&&await Promise.resolve(Qe(Me))&&(H=Q.DragCancel)}re.current=null,Ze.unstable_batchedUpdates(()=>{S({type:H}),R(Le.Uninitialized),gt(null),w(null),fe(null),Je.current=null;const Qe=H===Q.DragEnd?"onDragEnd":"onDragCancel";if(Me){const Xt=ce.current[Qe];Xt?.(Me),N({type:Qe,event:Me})}})}}},[A]),C=i.useCallback((T,P)=>(B,ae)=>{const q=B.nativeEvent,J=A.get(ae);if(re.current!==null||!J||q.dndKit||q.defaultPrevented)return;const ie={active:J};T(B,P.options,ie)===!0&&(q.dndKit={capturedBy:P.sensor},re.current=ae,b(B,P))},[A,b]),j=Js(u,C);oo(u),Se(()=>{F&&D===Le.Initializing&&R(Le.Initialized)},[F,D]),i.useEffect(()=>{const{onDragMove:T}=ce.current,{active:P,activatorEvent:B,collisions:ae,over:q}=ge.current;if(!P||!B)return;const J={active:P,activatorEvent:B,collisions:ae,delta:{x:Oe.x,y:Oe.y},over:q};Ze.unstable_batchedUpdates(()=>{T?.(J),N({type:"onDragMove",event:J})})},[Oe.x,Oe.y]),i.useEffect(()=>{const{active:T,activatorEvent:P,collisions:B,droppableContainers:ae,scrollAdjustedTranslate:q}=ge.current;if(!T||re.current==null||!P||!q)return;const{onDragOver:J}=ce.current,ie=ae.get(qe),K=ie&&ie.rect.current?{id:ie.id,rect:ie.rect.current,data:ie.data,disabled:ie.disabled}:null,H={active:T,activatorEvent:P,collisions:B,delta:{x:q.x,y:q.y},over:K};Ze.unstable_batchedUpdates(()=>{gt(K),J?.(H),N({type:"onDragOver",event:H})})},[qe]),Se(()=>{ge.current={activatorEvent:M,active:ne,activeNode:se,collisionRect:Te,collisions:Fe,droppableRects:de,draggableNodes:A,draggingNode:Ne,draggingNodeRect:Ae,droppableContainers:X,over:Ee,scrollableAncestors:Re,scrollAdjustedTranslate:Oe},te.current={initial:Ae,translated:Te}},[ne,se,Fe,Te,A,Ne,Ae,de,X,Ee,Re,Oe]),Ys({...ye,delta:_,draggingRect:Te,pointerCoordinates:ft,scrollableAncestors:Re,scrollableAncestorRects:Ue});const k=i.useMemo(()=>({active:ne,activeNode:se,activeNodeRect:F,activatorEvent:M,collisions:Fe,containerNodeRect:Ce,dragOverlay:oe,draggableNodes:A,droppableContainers:X,droppableRects:de,over:Ee,measureDroppableContainers:xe,scrollableAncestors:Re,scrollableAncestorRects:Ue,measuringConfiguration:ee,measuringScheduled:$e,windowRect:Ge}),[ne,se,F,M,Fe,Ce,oe,A,X,de,Ee,xe,Re,Ue,ee,$e,Ge]),U=i.useMemo(()=>({activatorEvent:M,activators:j,active:ne,activeNodeRect:F,ariaDescribedById:{draggable:he},dispatch:S,draggableNodes:A,over:Ee,measureDroppableContainers:xe}),[M,j,ne,F,S,he,A,Ee,xe]);return W.createElement(Jn.Provider,{value:x},W.createElement(ct.Provider,{value:U},W.createElement(hr.Provider,{value:k},W.createElement(Lt.Provider,{value:mt},f)),W.createElement(mo,{disabled:c?.restoreFocus===!1})),W.createElement(bs,{...c,hiddenTextDescribedById:he}));function z(){const T=De?.autoScrollEnabled===!1,P=typeof d=="object"?d.enabled===!1:d===!1,B=O&&!T&&!P;return typeof d=="object"?{...d,enabled:B}:{enabled:B}}}),xo=i.createContext(null),Rn="button",yo="Draggable";function wo(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const a=lt(yo),{activators:l,activatorEvent:c,active:d,activeNodeRect:f,ariaDescribedById:u,draggableNodes:h,over:m}=i.useContext(ct),{role:g=Rn,roleDescription:y="draggable",tabIndex:p=0}=o??{},v=d?.id===t,S=i.useContext(v?Lt:xo),[N,x]=wt(),[D,R]=wt(),O=ao(l,t),E=rt(n);Se(()=>(h.set(t,{id:t,key:a,node:N,activatorNode:D,data:E}),()=>{const _=h.get(t);_&&_.key===a&&h.delete(t)}),[h,t]);const A=i.useMemo(()=>({role:g,tabIndex:p,"aria-disabled":r,"aria-pressed":v&&g===Rn?!0:void 0,"aria-roledescription":y,"aria-describedby":u.draggable}),[r,g,p,v,y,u.draggable]);return{active:d,activatorEvent:c,activeNodeRect:f,attributes:A,isDragging:v,listeners:r?void 0:O,node:N,over:m,setNodeRef:x,setActivatorNodeRef:R,transform:S}}function mr(){return i.useContext(hr)}const Co="Droppable",So={timeout:25};function pr(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const a=lt(Co),{active:l,dispatch:c,over:d,measureDroppableContainers:f}=i.useContext(ct),u=i.useRef({disabled:n}),h=i.useRef(!1),m=i.useRef(null),g=i.useRef(null),{disabled:y,updateMeasurementsFor:p,timeout:v}={...So,...o},S=rt(p??r),N=i.useCallback(()=>{if(!h.current){h.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{f(Array.isArray(S.current)?S.current:[S.current]),g.current=null},v)},[v]),x=Mt({callback:N,disabled:y||!l}),D=i.useCallback((A,_)=>{x&&(_&&(x.unobserve(_),h.current=!1),A&&x.observe(A))},[x]),[R,O]=wt(D),E=rt(t);return i.useEffect(()=>{!x||!R.current||(x.disconnect(),h.current=!1,x.observe(R.current))},[R,x]),i.useEffect(()=>(c({type:Q.RegisterDroppable,element:{id:r,key:a,disabled:n,node:R,rect:m,data:E}}),()=>c({type:Q.UnregisterDroppable,key:a,id:r})),[r]),i.useEffect(()=>{n!==u.current.disabled&&(c({type:Q.SetDroppableDisabled,id:r,key:a,disabled:n}),u.current.disabled=n)},[r,a,n,c]),{active:l,rect:m,isOver:d?.id===r,node:R,over:d,setNodeRef:O}}function jo(e){let{animation:t,children:n}=e;const[r,o]=i.useState(null),[a,l]=i.useState(null),c=Ct(n);return!n&&!r&&c&&o(c),Se(()=>{if(!a)return;const d=r?.key,f=r?.props.id;if(d==null||f==null){o(null);return}Promise.resolve(t(f,a)).then(()=>{o(null)})},[t,r,a]),W.createElement(W.Fragment,null,n,r?i.cloneElement(r,{ref:l}):null)}const Do={x:0,y:0,scaleX:1,scaleY:1};function No(e){let{children:t}=e;return W.createElement(ct.Provider,{value:fr},W.createElement(Lt.Provider,{value:Do},t))}const Ro={position:"fixed",touchAction:"none"},Eo=e=>Ot(e)?"transform 250ms ease":void 0,ko=i.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:o,children:a,className:l,rect:c,style:d,transform:f,transition:u=Eo}=e;if(!c)return null;const h=o?f:{...f,scaleX:1,scaleY:1},m={...Ro,width:c.width,height:c.height,top:c.top,left:c.left,transform:Pe.Transform.toString(h),transformOrigin:o&&r?ws(r,c):void 0,transition:typeof u=="function"?u(r):u,...d};return W.createElement(n,{className:l,style:m,ref:t},a)}),Io=e=>t=>{let{active:n,dragOverlay:r}=t;const o={},{styles:a,className:l}=e;if(a!=null&&a.active)for(const[c,d]of Object.entries(a.active))d!==void 0&&(o[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,d));if(a!=null&&a.dragOverlay)for(const[c,d]of Object.entries(a.dragOverlay))d!==void 0&&r.node.style.setProperty(c,d);return l!=null&&l.active&&n.node.classList.add(l.active),l!=null&&l.dragOverlay&&r.node.classList.add(l.dragOverlay),function(){for(const[d,f]of Object.entries(o))n.node.style.setProperty(d,f);l!=null&&l.active&&n.node.classList.remove(l.active)}},Ao=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Pe.Transform.toString(t)},{transform:Pe.Transform.toString(n)}]},Oo={duration:250,easing:"ease",keyframes:Ao,sideEffects:Io({styles:{active:{opacity:"0"}}})};function To(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:o}=e;return At((a,l)=>{if(t===null)return;const c=n.get(a);if(!c)return;const d=c.node.current;if(!d)return;const f=ur(l);if(!f)return;const{transform:u}=le(l).getComputedStyle(l),h=tr(u);if(!h)return;const m=typeof t=="function"?t:Mo(t);return lr(d,o.draggable.measure),m({active:{id:a,data:c.data,node:d,rect:o.draggable.measure(d)},draggableNodes:n,dragOverlay:{node:l,rect:o.dragOverlay.measure(f)},droppableContainers:r,measuringConfiguration:o,transform:h})})}function Mo(e){const{duration:t,easing:n,sideEffects:r,keyframes:o}={...Oo,...e};return a=>{let{active:l,dragOverlay:c,transform:d,...f}=a;if(!t)return;const u={x:c.rect.left-l.rect.left,y:c.rect.top-l.rect.top},h={scaleX:d.scaleX!==1?l.rect.width*d.scaleX/c.rect.width:1,scaleY:d.scaleY!==1?l.rect.height*d.scaleY/c.rect.height:1},m={x:d.x-u.x,y:d.y-u.y,...h},g=o({...f,active:l,dragOverlay:c,transform:{initial:d,final:m}}),[y]=g,p=g[g.length-1];if(JSON.stringify(y)===JSON.stringify(p))return;const v=r?.({active:l,dragOverlay:c,...f}),S=c.node.animate(g,{duration:t,easing:n,fill:"forwards"});return new Promise(N=>{S.onfinish=()=>{v?.(),N()}})}}let En=0;function Lo(e){return i.useMemo(()=>{if(e!=null)return En++,En},[e])}const Po=W.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:o,transition:a,modifiers:l,wrapperElement:c="div",className:d,zIndex:f=999}=e;const{activatorEvent:u,active:h,activeNodeRect:m,containerNodeRect:g,draggableNodes:y,droppableContainers:p,dragOverlay:v,over:S,measuringConfiguration:N,scrollableAncestors:x,scrollableAncestorRects:D,windowRect:R}=mr(),O=i.useContext(Lt),E=Lo(h?.id),A=gr(l,{activatorEvent:u,active:h,activeNodeRect:m,containerNodeRect:g,draggingNodeRect:v.rect,over:S,overlayNodeRect:v.rect,scrollableAncestors:x,scrollableAncestorRects:D,transform:O,windowRect:R}),_=fn(m),X=To({config:r,draggableNodes:y,droppableContainers:p,measuringConfiguration:N}),$=_?v.setRef:void 0;return W.createElement(No,null,W.createElement(jo,{animation:X},h&&E?W.createElement(ko,{key:E,id:h.id,ref:$,as:c,activatorEvent:u,adjustScale:t,className:d,transition:a,rect:_,style:{zIndex:f,...o},transform:A},n):null))});function Nt(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function $o(e,t){return e.reduce((n,r,o)=>{const a=t.get(r);return a&&(n[o]=a),n},Array(e.length))}function vt(e){return e!==null&&e>=0}function Fo(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Bo(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const vr=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const a=Nt(t,r,n),l=t[o],c=a[o];return!c||!l?null:{x:c.left-l.left,y:c.top-l.top,scaleX:c.width/l.width,scaleY:c.height/l.height}},bt={scaleX:1,scaleY:1},zo=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:a,overIndex:l}=e;const c=(t=a[n])!=null?t:r;if(!c)return null;if(o===n){const f=a[l];return f?{x:0,y:n<l?f.top+f.height-(c.top+c.height):f.top-c.top,...bt}:null}const d=_o(a,o,n);return o>n&&o<=l?{x:0,y:-c.height-d,...bt}:o<n&&o>=l?{x:0,y:c.height+d,...bt}:{x:0,y:0,...bt}};function _o(e,t,n){const r=e[t],o=e[t-1],a=e[t+1];return r?n<t?o?r.top-(o.top+o.height):a?a.top-(r.top+r.height):0:a?a.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}const br="Sortable",xr=W.createContext({activeIndex:-1,containerId:br,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:vr,disabled:{draggable:!1,droppable:!1}});function Uo(e){let{children:t,id:n,items:r,strategy:o=vr,disabled:a=!1}=e;const{active:l,dragOverlay:c,droppableRects:d,over:f,measureDroppableContainers:u}=mr(),h=lt(br,n),m=c.rect!==null,g=i.useMemo(()=>r.map(O=>typeof O=="object"&&"id"in O?O.id:O),[r]),y=l!=null,p=l?g.indexOf(l.id):-1,v=f?g.indexOf(f.id):-1,S=i.useRef(g),N=!Fo(g,S.current),x=v!==-1&&p===-1||N,D=Bo(a);Se(()=>{N&&y&&u(g)},[N,g,y,u]),i.useEffect(()=>{S.current=g},[g]);const R=i.useMemo(()=>({activeIndex:p,containerId:h,disabled:D,disableTransforms:x,items:g,overIndex:v,useDragOverlay:m,sortedRects:$o(g,d),strategy:o}),[p,h,D.draggable,D.droppable,x,g,v,d,m,o]);return W.createElement(xr.Provider,{value:R},t)}const Ko=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return Nt(n,r,o).indexOf(t)},Xo=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:a,newIndex:l,previousItems:c,previousContainerId:d,transition:f}=e;return!f||!r||c!==a&&o===l?!1:n?!0:l!==o&&t===d},Ho={duration:200,easing:"ease"},yr="transform",Vo=Pe.Transition.toString({property:yr,duration:0,easing:"linear"}),Yo={roleDescription:"sortable"};function Wo(e){let{disabled:t,index:n,node:r,rect:o}=e;const[a,l]=i.useState(null),c=i.useRef(n);return Se(()=>{if(!t&&n!==c.current&&r.current){const d=o.current;if(d){const f=We(r.current,{ignoreTransform:!0}),u={x:d.left-f.left,y:d.top-f.top,scaleX:d.width/f.width,scaleY:d.height/f.height};(u.x||u.y)&&l(u)}}n!==c.current&&(c.current=n)},[t,n,r,o]),i.useEffect(()=>{a&&l(null)},[a]),a}function Go(e){let{animateLayoutChanges:t=Xo,attributes:n,disabled:r,data:o,getNewIndex:a=Ko,id:l,strategy:c,resizeObserverConfig:d,transition:f=Ho}=e;const{items:u,containerId:h,activeIndex:m,disabled:g,disableTransforms:y,sortedRects:p,overIndex:v,useDragOverlay:S,strategy:N}=i.useContext(xr),x=qo(r,g),D=u.indexOf(l),R=i.useMemo(()=>({sortable:{containerId:h,index:D,items:u},...o}),[h,o,D,u]),O=i.useMemo(()=>u.slice(u.indexOf(l)),[u,l]),{rect:E,node:A,isOver:_,setNodeRef:X}=pr({id:l,data:R,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:O,...d}}),{active:$,activatorEvent:te,activeNodeRect:ne,attributes:re,setNodeRef:De,listeners:w,isDragging:M,over:fe,setActivatorNodeRef:ce,transform:he}=wo({id:l,data:R,attributes:{...Yo,...n},disabled:x.draggable}),ke=os(X,De),ee=!!$,de=ee&&!y&&vt(m)&&vt(v),xe=!S&&M,$e=xe&&de?he:null,_e=de?$e??(c??N)({rects:p,activeNodeRect:ne,activeIndex:m,overIndex:v,index:D}):null,ye=vt(m)&&vt(v)?a({id:l,items:u,activeIndex:m,overIndex:v}):D,we=$?.id,F=i.useRef({activeId:we,items:u,newIndex:ye,containerId:h}),Ce=u!==F.current.items,ge=t({active:$,containerId:h,isDragging:M,isSorting:ee,id:l,index:D,items:u,newIndex:F.current.newIndex,previousItems:F.current.items,previousContainerId:F.current.containerId,transition:f,wasDragging:F.current.activeId!=null}),Ie=Wo({disabled:!ge,index:D,node:A,rect:E});return i.useEffect(()=>{ee&&F.current.newIndex!==ye&&(F.current.newIndex=ye),h!==F.current.containerId&&(F.current.containerId=h),u!==F.current.items&&(F.current.items=u)},[ee,ye,h,u]),i.useEffect(()=>{if(we===F.current.activeId)return;if(we!=null&&F.current.activeId==null){F.current.activeId=we;return}const Ne=setTimeout(()=>{F.current.activeId=we},50);return()=>clearTimeout(Ne)},[we]),{active:$,activeIndex:m,attributes:re,data:R,rect:E,index:D,newIndex:ye,items:u,isOver:_,isSorting:ee,isDragging:M,listeners:w,node:A,overIndex:v,over:fe,setNodeRef:ke,setActivatorNodeRef:ce,setDroppableNodeRef:X,setDraggableNodeRef:De,transform:Ie??_e,transition:oe()};function oe(){if(Ie||Ce&&F.current.newIndex===D)return Vo;if(!(xe&&!Ot(te)||!f)&&(ee||ge))return Pe.Transition.toString({...f,property:yr})}}function qo(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(r=e?.droppable)!=null?r:t.droppable}}function Rt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Jo=[L.Down,L.Right,L.Up,L.Left],Qo=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:a,over:l,scrollableAncestors:c}}=t;if(Jo.includes(e.code)){if(e.preventDefault(),!n||!r)return;const d=[];a.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const m=o.get(h.id);if(m)switch(e.code){case L.Down:r.top<m.top&&d.push(h);break;case L.Up:r.top>m.top&&d.push(h);break;case L.Left:r.left>m.left&&d.push(h);break;case L.Right:r.left<m.left&&d.push(h);break}});const f=Zn({collisionRect:r,droppableRects:o,droppableContainers:d});let u=Qn(f,"id");if(u===l?.id&&f.length>1&&(u=f[1].id),u!=null){const h=a.get(n.id),m=a.get(u),g=m?o.get(m.id):null,y=m?.node.current;if(y&&g&&h&&m){const v=Tt(y).some((O,E)=>c[E]!==O),S=wr(h,m),N=Zo(h,m),x=v||!S?{x:0,y:0}:{x:N?r.width-g.width:0,y:N?r.height-g.height:0},D={x:g.left,y:g.top};return x.x&&x.y?D:st(D,x)}}}};function wr(e,t){return!Rt(e)||!Rt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Zo(e,t){return!Rt(e)||!Rt(t)||!wr(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Pt={default:{label:"Default",bg:"bg-muted/50",border:"border-border",dot:"bg-gray-400"},yellow:{label:"Investigating",bg:"bg-yellow-500/10",border:"border-yellow-500/30",dot:"bg-yellow-500"},orange:{label:"Identified",bg:"bg-orange-500/10",border:"border-orange-500/30",dot:"bg-orange-500"},purple:{label:"Fixing",bg:"bg-purple-500/10",border:"border-purple-500/30",dot:"bg-purple-500"},blue:{label:"Monitoring",bg:"bg-blue-500/10",border:"border-blue-500/30",dot:"bg-blue-500"},green:{label:"Resolved",bg:"bg-green-500/10",border:"border-green-500/30",dot:"bg-green-500"},red:{label:"Critical",bg:"bg-red-500/10",border:"border-red-500/30",dot:"bg-red-500"},pink:{label:"Review",bg:"bg-pink-500/10",border:"border-pink-500/30",dot:"bg-pink-500"}},hn=Pt;function rn(){return Math.random().toString(36).substring(2,9)}const kn="Dbochman",In="personal-website",ea=120*1e3,sn=new Map;function An(e){const t=sn.get(e);return t?Date.now()-t.timestamp>ea?(sn.delete(e),{hit:!1,status:null}):{hit:!0,status:t.status}:{hit:!1,status:null}}function ta(e,t){sn.set(e,{status:t,timestamp:Date.now()})}async function na(e){try{const t=await fetch(`https://api.github.com/repos/${kn}/${In}/pulls/${e}`,{headers:{Accept:"application/vnd.github.v3+json"}});if(!t.ok)return t.status===404||t.status===403&&console.warn("GitHub API rate limit reached"),null;const r=(await t.json()).head.sha,o=await fetch(`https://api.github.com/repos/${kn}/${In}/commits/${r}/check-runs`,{headers:{Accept:"application/vnd.github.v3+json"}});if(!o.ok)return null;const a=await o.json();return a.total_count===0?null:a.check_runs.some(d=>d.conclusion==="failure"||d.conclusion==="timed_out")?"failing":a.check_runs.some(d=>d.status==="queued"||d.status==="in_progress")?"pending":"passing"}catch(t){return console.error("Error fetching PR status:",t),null}}function ra(e){const[t,n]=i.useState(()=>{if(e===null)return null;const a=An(e);return a.hit?a.status:null}),[r,o]=i.useState(!1);return i.useEffect(()=>{if(e===null){n(null),o(!1);return}const a=An(e);if(a.hit){n(a.status),o(!1);return}let l=!1;return o(!0),na(e).then(c=>{l||(ta(e,c),n(c),o(!1))}),()=>{l=!0}},[e]),{status:t,loading:r}}const On="https://github.com/Dbochman/personal-website";function Cr(e){const t=e.match(/^PR #(\d+)$/);return t?parseInt(t[1],10):null}function sa(e){if(!e)return null;for(const t of e){const n=Cr(t);if(n)return n}return null}function Tn(e){return e?e.some(t=>t.startsWith("PR #")):!1}function Sr({card:e,columnId:t,onEdit:n,isDragOverlay:r=!1}){const{attributes:o,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:f}=Go({id:e.id,disabled:r}),u=t==="changelog",m=t==="in-review"&&!e.prStatus&&!r?sa(e.labels):null,{status:g,loading:y}=ra(m),p=e.prStatus??g,v=r?void 0:{transform:Pe.Transform.toString(c),transition:d},S=e.color?hn[e.color]:null,N=r?{}:{ref:l,...o,...a};return s.jsxs(Rr,{style:v,className:ue("p-3 border shadow-xs cursor-grab active:cursor-grabbing touch-none group relative",S?S.bg:"bg-background",S&&S.border,f&&"opacity-50",r&&"shadow-lg rotate-3"),...N,children:[s.jsxs("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity z-10 flex gap-1",children:[s.jsx("button",{onClick:x=>{x.stopPropagation();const D=new URL(window.location.href),R=D.searchParams.get("board")||"roadmap";D.search=`?board=${R}&card=${e.id}`,navigator.clipboard.writeText(D.toString())},onPointerDown:x=>x.stopPropagation(),className:"text-muted-foreground hover:text-foreground p-1 rounded hover:bg-muted","aria-label":`Copy link to ${e.title}`,title:"Copy card link",children:s.jsx(Ir,{className:"w-3.5 h-3.5"})}),n&&s.jsx("button",{onClick:x=>{x.stopPropagation(),n(e)},onPointerDown:x=>x.stopPropagation(),className:"text-muted-foreground hover:text-foreground p-1 rounded hover:bg-muted","aria-label":`Edit ${e.title}`,children:s.jsx(Ln,{className:"w-3.5 h-3.5"})})]}),s.jsxs("div",{className:"pr-6",children:[s.jsx("p",{className:"font-medium text-sm wrap-break-word",children:e.title}),(e.summary||e.description)&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1 wrap-break-word",children:e.summary||e.description}),e.labels&&e.labels.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:e.labels.map(x=>{const D=Cr(x);return D?s.jsx("a",{href:`${On}/pull/${D}`,target:"_blank",rel:"noopener noreferrer",onClick:R=>R.stopPropagation(),onPointerDown:R=>R.stopPropagation(),className:"inline-flex",children:s.jsxs(Qt,{variant:"secondary",className:"text-xs px-1.5 py-0 hover:bg-primary/20 transition-colors cursor-pointer",children:[x,s.jsx(Pn,{className:"w-2.5 h-2.5 ml-1 opacity-60"})]})},x):s.jsx(Qt,{variant:"secondary",className:"text-xs px-1.5 py-0",children:x},x)})}),(e.checklist?.length||e.planFile||p||y||u&&Tn(e.labels))&&s.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs text-muted-foreground",children:[u&&Tn(e.labels)&&s.jsx("div",{className:"flex items-center gap-1",title:"Merged",children:s.jsx(Ar,{className:"w-3.5 h-3.5 text-purple-500"})}),!u&&y&&s.jsx("div",{className:"flex items-center gap-1",title:"Checking CI status...",children:s.jsx(Et,{className:"w-3.5 h-3.5 text-muted-foreground animate-spin"})}),!u&&!y&&p&&s.jsxs("div",{className:"flex items-center gap-1",title:`CI: ${p}`,children:[p==="passing"&&s.jsx(Or,{className:"w-3.5 h-3.5 text-green-500"}),p==="failing"&&s.jsx(Tr,{className:"w-3.5 h-3.5 text-red-500"}),p==="pending"&&s.jsx(Mr,{className:"w-3.5 h-3.5 text-yellow-500"})]}),e.checklist&&e.checklist.length>0&&s.jsxs("button",{onClick:x=>{x.stopPropagation(),n?.(e,"checklist")},onPointerDown:x=>x.stopPropagation(),className:"flex items-center gap-1 hover:text-primary transition-colors",title:"View checklist",children:[s.jsx(Lr,{className:"w-3 h-3"}),s.jsxs("span",{children:[e.checklist.filter(x=>x.completed).length,"/",e.checklist.length]})]}),e.planFile&&s.jsx("a",{href:`${On}/blob/main/${e.planFile}`,target:"_blank",rel:"noopener noreferrer",onClick:x=>x.stopPropagation(),onPointerDown:x=>x.stopPropagation(),className:"flex items-center gap-1 hover:text-primary transition-colors",title:"View plan document",children:s.jsx($n,{className:"w-3 h-3"})})]})]})]})}const Gt=7;function Mn(e){if(!e)return 50;for(const t of e){const n=t.toLowerCase();if(n==="small")return 10;if(n==="small-medium")return 25;if(n==="medium")return 50;if(n==="medium-large")return 75;if(n==="large")return 100}return 50}function oa({column:e,boardId:t,onAddCard:n,onEditCard:r,onEditColumn:o,onDeleteColumn:a}){const{setNodeRef:l,isOver:c}=pr({id:e.id}),[d,f]=i.useState("none"),u=e.id==="changelog",h=u&&e.cards.length>Gt,m=i.useMemo(()=>{let v=e.cards;return u&&v.length>Gt&&(v=v.slice(0,Gt)),d==="none"?v:[...v].sort((S,N)=>{const x=Mn(S.labels),D=Mn(N.labels);return d==="asc"?x-D:D-x})},[e.cards,d,u]),g=()=>{f(v=>v==="none"?"asc":v==="asc"?"desc":"none")},y=d==="asc"?Pr:d==="desc"?$r:Fr,p=Pt[e.color||"default"];return s.jsxs("div",{className:ue("shrink-0 w-64 rounded-lg p-3 border",p.bg,p.border,c&&"ring-2 ring-primary ring-offset-2 ring-offset-background"),children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-semibold text-sm",children:e.title}),s.jsx("span",{className:"text-muted-foreground text-xs bg-background/50 px-1.5 py-0.5 rounded",children:e.cards.length})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsxs(G,{variant:"ghost",size:"icon",className:ue("h-7 w-7",d!=="none"&&"text-primary"),onClick:g,title:d==="none"?"Sort by size":d==="asc"?"Sorted: small first":"Sorted: large first",children:[s.jsx(y,{className:"w-4 h-4"}),s.jsx("span",{className:"sr-only",children:"Sort by size"})]}),s.jsxs(Hn,{children:[s.jsx(Vn,{asChild:!0,children:s.jsxs(G,{variant:"ghost",size:"icon",className:"h-7 w-7",children:[s.jsx(Br,{className:"w-4 h-4"}),s.jsx("span",{className:"sr-only",children:"Column options"})]})}),s.jsxs(Yn,{align:"end",children:[s.jsxs(yt,{onClick:()=>o(e.id),children:[s.jsx(Ln,{className:"w-4 h-4 mr-2"}),"Edit"]}),s.jsxs(yt,{onClick:()=>a(e.id),className:"text-destructive focus:text-destructive",children:[s.jsx(zr,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})]}),e.description&&s.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:e.description}),!e.description&&s.jsx("div",{className:"mb-2"}),s.jsxs("div",{ref:l,className:"min-h-[50px]",children:[s.jsx(Uo,{items:m.map(v=>v.id),strategy:zo,children:s.jsx("div",{className:"space-y-2",children:m.map(v=>s.jsx(Sr,{card:v,columnId:e.id,onEdit:r},v.id))})}),h&&s.jsxs("a",{href:`/projects/changelog?board=${t}`,className:"flex items-center gap-2 mt-3 px-3 py-2 text-xs text-muted-foreground hover:text-foreground bg-background/50 rounded border border-dashed border-border hover:border-primary/50 transition-colors",children:[s.jsx(_r,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"View full Change Log"})]})]}),s.jsxs(G,{variant:"ghost",size:"sm",className:"w-full mt-3 justify-start text-muted-foreground hover:text-foreground",onClick:()=>n(e.id),children:[s.jsx(kt,{className:"w-4 h-4 mr-1"}),"Add card"]})]})}const gn=Ur,aa=Kr,jr=i.forwardRef(({className:e,...t},n)=>s.jsx(_n,{ref:n,className:ue("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));jr.displayName=_n.displayName;const $t=i.forwardRef(({className:e,children:t,...n},r)=>s.jsxs(aa,{children:[s.jsx(jr,{}),s.jsxs(Fn,{ref:r,className:ue("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,s.jsxs(Xr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-hidden focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx(Zt,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));$t.displayName=Fn.displayName;const Ft=({className:e,...t})=>s.jsx("div",{className:ue("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Ft.displayName="DialogHeader";const Bt=({className:e,...t})=>s.jsx("div",{className:ue("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Bt.displayName="DialogFooter";const zt=i.forwardRef(({className:e,...t},n)=>s.jsx(Bn,{ref:n,className:ue("text-lg font-semibold leading-none tracking-tight",e),...t}));zt.displayName=Bn.displayName;const Dr=i.forwardRef(({className:e,...t},n)=>s.jsx(zn,{ref:n,className:ue("text-sm text-muted-foreground",e),...t}));Dr.displayName=zn.displayName;const Nr=i.forwardRef(({className:e,...t},n)=>s.jsx(Un,{ref:n,className:ue("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:s.jsx(Hr,{className:ue("flex items-center justify-center text-current"),children:s.jsx(Kn,{className:"h-4 w-4"})})}));Nr.displayName=Un.displayName;function ia({cardId:e}){const t=i.useRef(null),[n,r]=i.useState(!1),{isDark:o}=Er(),a=i.useRef(null);i.useEffect(()=>{if(!t.current)return;const f=new IntersectionObserver(u=>{u[0].isIntersecting&&(r(!0),f.disconnect())},{rootMargin:"100px"});return f.observe(t.current),()=>f.disconnect()},[]);const l=i.useCallback(()=>o?"dark":"light",[o]),c=f=>{t.current?.querySelector("iframe.giscus-frame")?.contentWindow?.postMessage({giscus:{setConfig:{theme:f}}},"https://giscus.app")},d=i.useCallback(f=>{if(!t.current)return;t.current.innerHTML="";const u=document.createElement("script");u.src="https://giscus.app/client.js",u.setAttribute("data-repo","Dbochman/personal-website"),u.setAttribute("data-repo-id","R_kgDOO7-rBw"),u.setAttribute("data-category","General"),u.setAttribute("data-category-id","DIC_kwDOO7-rB84C0ubL"),u.setAttribute("data-mapping","specific"),u.setAttribute("data-term",`kanban-${e}`),u.setAttribute("data-strict","0"),u.setAttribute("data-reactions-enabled","1"),u.setAttribute("data-emit-metadata","0"),u.setAttribute("data-input-position","bottom"),u.setAttribute("data-theme",f),u.setAttribute("data-lang","en"),u.setAttribute("crossorigin","anonymous"),u.async=!0,t.current.appendChild(u)},[e]);return i.useEffect(()=>{if(!n||!t.current)return;const f=l();if(a.current!==e){a.current=e,d(f);return}c(f)},[n,e,o,l,d]),s.jsx("div",{ref:t,className:"giscus-container min-h-[200px]",children:!n&&s.jsx("div",{className:"text-center text-muted-foreground py-8 text-sm",children:"Scroll to load comments..."})})}const la=Object.keys(hn);function qt(e){return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}function ca(e){switch(e.type){case"column":return`Moved to ${e.columnTitle}`;case"title":return`Title: "${e.from}"  "${e.to}"`;case"description":return e.from?e.to?"Description updated":"Description removed":"Description added";case"labels":return`Labels: ${e.from||"(none)"}  ${e.to||"(none)"}`;default:return"Updated"}}function da({card:e,isOpen:t,scrollTo:n,onClose:r,onSave:o,onDelete:a}){const l=i.useRef(null),[c,d]=i.useState(""),[f,u]=i.useState(""),[h,m]=i.useState(""),[g,y]=i.useState([]),[p,v]=i.useState(""),[S,N]=i.useState([]),[x,D]=i.useState(""),[R,O]=i.useState(void 0);i.useEffect(()=>{e?(d(e.title),u(e.summary||""),m(e.description||""),y(e.labels||[]),N(e.checklist||[]),O(e.color)):(d(""),u(""),m(""),y([]),N([]),O(void 0)),v(""),D("")},[e]),i.useEffect(()=>{t&&n==="checklist"&&l.current&&setTimeout(()=>{l.current?.scrollIntoView({behavior:"smooth",block:"center"})},100)},[t,n]);const E=()=>{if(!c.trim())return;const w=new Date().toISOString(),M=[...e?.history||[]];if(e){const fe=c.trim(),ce=h.trim(),he=(e.labels||[]).join(", "),ke=g.join(", ");fe!==e.title&&M.push({type:"title",timestamp:w,from:e.title,to:fe}),ce!==(e.description||"")&&M.push({type:"description",timestamp:w,from:e.description||"",to:ce}),ke!==he&&M.push({type:"labels",timestamp:w,from:he,to:ke})}o({id:e?.id||rn(),title:c.trim(),summary:f.trim()||void 0,description:h.trim()||void 0,labels:g.length>0?g:void 0,checklist:S.length>0?S:void 0,color:R,createdAt:e?.createdAt||w,history:M.length>0?M:void 0}),r()},A=()=>{p.trim()&&!g.includes(p.trim())&&(y([...g,p.trim()]),v(""))},_=w=>{y(g.filter(M=>M!==w))},X=w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),A())},$=()=>{x.trim()&&(N([...S,{id:rn(),text:x.trim(),completed:!1}]),D(""))},te=w=>{N(S.map(M=>M.id===w?{...M,completed:!M.completed}:M))},ne=w=>{N(S.filter(M=>M.id!==w))},re=w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),$())},De=S.filter(w=>w.completed).length;return s.jsx(gn,{open:t,onOpenChange:r,children:s.jsxs($t,{className:"sm:max-w-[475px] max-h-[90vh] overflow-y-auto",children:[s.jsx(Ft,{children:s.jsx(zt,{children:e?"Edit Card":"New Card"})}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{htmlFor:"title",children:"Title"}),s.jsx(ze,{id:"title",value:c,onChange:w=>d(w.target.value),placeholder:"Card title",autoFocus:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{htmlFor:"summary",children:"Summary"}),s.jsx(ze,{id:"summary",value:f,onChange:w=>u(w.target.value),placeholder:"Short one-liner for card preview"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{htmlFor:"description",children:"Description"}),s.jsx(Wn,{id:"description",value:h,onChange:w=>m(w.target.value),placeholder:"Full details (shown when editing)",rows:2})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{htmlFor:"labels",children:"Labels"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ze,{id:"labels",value:p,onChange:w=>v(w.target.value),onKeyDown:X,placeholder:"Add a label",className:"flex-1"}),s.jsx(G,{type:"button",variant:"secondary",size:"sm",onClick:A,children:"Add"})]}),g.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:g.map(w=>s.jsxs(Qt,{variant:"secondary",className:"pr-1",children:[w,s.jsx("button",{onClick:()=>_(w),className:"ml-1 hover:text-destructive","aria-label":`Remove ${w} label`,children:s.jsx(Zt,{className:"w-3 h-3"})})]},w))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{children:"Color (optional)"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{type:"button",onClick:()=>O(void 0),title:"None",className:ue("w-8 h-8 rounded-full border-2 transition-all bg-background",R?"border-border hover:scale-110":"border-primary ring-2 ring-primary ring-offset-2 ring-offset-background"),children:s.jsx("span",{className:"sr-only",children:"None"})}),la.filter(w=>w!=="default").map(w=>{const M=hn[w],fe=R===w;return s.jsx("button",{type:"button",onClick:()=>O(w),title:M.label,className:ue("w-8 h-8 rounded-full border-2 transition-all",M.dot,fe?"border-primary ring-2 ring-primary ring-offset-2 ring-offset-background":"border-transparent hover:scale-110"),children:s.jsx("span",{className:"sr-only",children:M.label})},w)})]})]}),s.jsxs("div",{ref:l,className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ve,{children:"Checklist"}),S.length>0&&s.jsxs("span",{className:"text-xs text-muted-foreground",children:[De,"/",S.length]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ze,{value:x,onChange:w=>D(w.target.value),onKeyDown:re,placeholder:"Add subtask...",className:"flex-1"}),s.jsx(G,{type:"button",variant:"secondary",size:"sm",onClick:$,children:s.jsx(kt,{className:"w-4 h-4"})})]}),S.length>0&&s.jsx("div",{className:"space-y-1 mt-2",children:S.map(w=>s.jsxs("div",{className:"flex items-center gap-2 group",children:[s.jsx(Nr,{id:w.id,checked:w.completed,onCheckedChange:()=>te(w.id)}),s.jsx("label",{htmlFor:w.id,className:`flex-1 text-sm cursor-pointer ${w.completed?"line-through text-muted-foreground":""}`,children:w.text}),s.jsx("button",{onClick:()=>ne(w.id),className:"opacity-0 group-hover:opacity-100 text-muted-foreground hover:text-destructive transition-opacity","aria-label":`Remove ${w.text}`,children:s.jsx(Zt,{className:"w-3 h-3"})})]},w.id))})]}),e?.planFile&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{children:"Plan Document"}),s.jsxs("a",{href:`https://github.com/Dbochman/personal-website/blob/main/${e.planFile}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-2 rounded-md border bg-muted/50 hover:bg-muted transition-colors text-sm",children:[s.jsx($n,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"flex-1 truncate",children:e.planFile.split("/").pop()}),s.jsx(Pn,{className:"w-3 h-3 text-muted-foreground"})]})]}),e&&s.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[s.jsxs("span",{children:["Created: ",qt(e.createdAt)]}),e.updatedAt&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["Updated: ",qt(e.updatedAt)]})]})]}),e.history&&e.history.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(Vr,{className:"w-3 h-3"}),s.jsx("span",{children:"History"})]}),s.jsx("div",{className:"text-xs text-muted-foreground space-y-2 max-h-32 overflow-y-auto",children:[...e.history].reverse().map((w,M)=>s.jsxs("div",{className:"flex flex-col gap-0.5",children:[s.jsx("span",{className:"wrap-break-word",children:ca(w)}),s.jsx("span",{className:"text-muted-foreground/70",children:qt(w.timestamp)})]},M))})]})]}),e&&s.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(Yr,{className:"w-3 h-3"}),s.jsx("span",{children:"Discussion"})]}),s.jsx(ia,{cardId:e.id})]})]}),s.jsxs(Bt,{className:"gap-2 sm:gap-0",children:[e&&a&&s.jsx(G,{type:"button",variant:"destructive",onClick:()=>{a(e.id),r()},className:"mr-auto",children:"Delete"}),s.jsx(G,{type:"button",variant:"outline",onClick:r,children:"Cancel"}),s.jsx(G,{type:"button",onClick:E,disabled:!c.trim(),children:e?"Save":"Create"})]})]})})}const ua=Object.keys(Pt);function fa({column:e,isOpen:t,onClose:n,onSave:r,onDelete:o}){const[a,l]=i.useState(""),[c,d]=i.useState(""),[f,u]=i.useState("default");i.useEffect(()=>{e?(l(e.title),d(e.description||""),u(e.color||"default")):(l(""),d(""),u("default"))},[e]);const h=()=>{a.trim()&&(r({title:a.trim(),description:c.trim()||void 0,color:f!=="default"?f:void 0}),n())},m=g=>{g.key==="Enter"&&g.target instanceof HTMLInputElement&&(g.preventDefault(),h())};return s.jsx(gn,{open:t,onOpenChange:n,children:s.jsxs($t,{className:"sm:max-w-[400px]",children:[s.jsx(Ft,{children:s.jsx(zt,{children:e?"Edit Column":"New Column"})}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{htmlFor:"column-title",children:"Name"}),s.jsx(ze,{id:"column-title",value:a,onChange:g=>l(g.target.value),onKeyDown:m,placeholder:"Column name",autoFocus:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{htmlFor:"column-description",children:"Description (optional)"}),s.jsx(Wn,{id:"column-description",value:c,onChange:g=>d(g.target.value),placeholder:"What belongs in this column?",rows:2})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{children:"Color"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:ua.map(g=>{const y=Pt[g],p=f===g;return s.jsx("button",{type:"button",onClick:()=>u(g),title:y.label,className:ue("w-8 h-8 rounded-full border-2 transition-all",y.dot,p?"border-primary ring-2 ring-primary ring-offset-2 ring-offset-background":"border-transparent hover:scale-110"),children:s.jsx("span",{className:"sr-only",children:y.label})},g)})})]})]}),s.jsxs(Bt,{className:"gap-2 sm:gap-0",children:[e&&o&&s.jsx(G,{type:"button",variant:"destructive",onClick:()=>{o(e.id),n()},className:"mr-auto",children:"Delete"}),s.jsx(G,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),s.jsx(G,{type:"button",onClick:h,disabled:!a.trim(),children:e?"Save":"Create"})]})]})})}const ha="https://api.dylanbochman.com",ga=Object.entries(rs).map(([e,t])=>({id:e,title:t.title||e,cardCount:t.cardCount??0}));function Jt(e){const t=new Map;for(const n of ga)t.set(n.id,n);if(e)for(const n of e)t.set(n.id,n);return Array.from(t.values()).sort((n,r)=>n.title.localeCompare(r.title))}function ma({currentBoardId:e,currentBoardTitle:t,onCreateNew:n,isAuthenticated:r}){const[,o]=Xn(),[a,l]=i.useState([]),[c,d]=i.useState(!0),[f,u]=i.useState(!1),h=i.useCallback(async()=>{d(!0);try{const y=await fetch(`${ha}/boards`,{credentials:"include"});if(y.ok){const p=await y.json();l(Jt(p.boards||[]));return}l(Jt(null))}catch(y){console.error("Failed to load boards:",y),l(Jt(null))}finally{d(!1)}},[]);i.useEffect(()=>{h()},[h]);function m(y){u(y),y&&h()}function g(y){o(p=>{const v=new URLSearchParams(p);return v.set("board",y),v.delete("card"),v}),u(!1)}return s.jsxs(Hn,{open:f,onOpenChange:m,children:[s.jsx(Vn,{asChild:!0,children:s.jsxs(G,{variant:"outline",className:"gap-2",children:[s.jsx(Wr,{className:"h-4 w-4"}),s.jsx("span",{className:"max-w-[150px] truncate",children:t}),s.jsx(Gr,{className:"h-4 w-4 opacity-50"})]})}),s.jsxs(Yn,{align:"start",className:"w-56",children:[c?s.jsx("div",{className:"flex items-center justify-center py-4",children:s.jsx(Et,{className:"h-4 w-4 animate-spin"})}):a.length===0?s.jsx("div",{className:"px-2 py-4 text-sm text-muted-foreground text-center",children:"No boards found"}):a.map(y=>s.jsxs(yt,{onSelect:()=>g(y.id),className:y.id===e?"bg-accent":"",children:[s.jsx("span",{className:"flex-1 truncate",children:y.title}),s.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:y.cardCount})]},y.id)),r&&s.jsxs(s.Fragment,{children:[s.jsx(ns,{}),s.jsxs(yt,{onSelect:n,children:[s.jsx(kt,{className:"h-4 w-4 mr-2"}),"New Board..."]})]})]})]})}const pa="https://api.dylanbochman.com";function va({isOpen:e,onClose:t,onCreated:n}){const[r,o]=i.useState(""),[a,l]=i.useState(""),[c,d]=i.useState(!1),[f,u]=i.useState(!1),[h,m]=i.useState(null);i.useEffect(()=>{if(!c){const p=r.toLowerCase().replace(/[^a-z0-9]+/g,"-").slice(0,50).replace(/^-|-$/g,"");l(p)}},[r,c]),i.useEffect(()=>{e||(o(""),l(""),d(!1),m(null))},[e]);function g(p){l(p),d(!0)}async function y(){if(!a||!r){m("Title and ID are required");return}if(!/^[a-z0-9][a-z0-9-]{0,48}[a-z0-9]?$/.test(a)){m("ID must be lowercase letters, numbers, and hyphens only");return}u(!0),m(null);try{const p=await fetch(`${pa}/boards`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a,title:r})}),v=await p.json();if(!p.ok){v.error==="board_exists"?m("A board with this ID already exists"):v.error==="not_authenticated"?m("You must be logged in to create boards"):m(v.message||v.error||"Failed to create board");return}n(v.boardId),t()}catch(p){m(p instanceof Error?p.message:"Network error")}finally{u(!1)}}return s.jsx(gn,{open:e,onOpenChange:p=>!p&&t(),children:s.jsxs($t,{className:"sm:max-w-md",children:[s.jsxs(Ft,{children:[s.jsx(zt,{children:"Create New Board"}),s.jsx(Dr,{children:"Create a new kanban board to organize your tasks."})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{htmlFor:"board-title",children:"Board Title"}),s.jsx(ze,{id:"board-title",value:r,onChange:p=>o(p.target.value),placeholder:"My Project Board",autoFocus:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ve,{htmlFor:"board-id",children:"Board ID"}),s.jsx(ze,{id:"board-id",value:a,onChange:p=>g(p.target.value),placeholder:"my-project-board",className:"font-mono text-sm"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Used in URLs: /projects/kanban?board=",s.jsx("span",{className:"font-mono",children:a||"my-board"})]})]}),h&&s.jsx("p",{className:"text-sm text-destructive",children:h})]}),s.jsxs(Bt,{children:[s.jsx(G,{variant:"outline",onClick:t,disabled:f,children:"Cancel"}),s.jsx(G,{onClick:y,disabled:!a||!r||f,children:f?s.jsxs(s.Fragment,{children:[s.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):"Create Board"})]})]})})}const Xe="https://api.dylanbochman.com";function Na({initialBoard:e,boardId:t,initialCardId:n,initialHeadCommitSha:r}){const[,o]=Xn(),[a,l]=i.useState(e),c=i.useRef(e),[d,f]=i.useState(r??null),u=`kanban-deleted-cards-${t}`,[h,m]=i.useState(()=>{if(typeof window>"u")return[];try{const b=localStorage.getItem(u);if(!b)return[];const C=JSON.parse(b),j=new Set(e.columns.flatMap(k=>k.cards.map(U=>U.id)));return C.filter(k=>j.has(k))}catch{return[]}}),[g,y]=i.useState(null),[p,v]=i.useState(!1),[S,N]=i.useState(!1),[x,D]=i.useState(!1),[R,O]=i.useState(!1),[E,A]=i.useState({authenticated:!1,username:null}),[_,X]=i.useState(!0),[$,te]=i.useState(!1),ne=i.useRef(!1),re=i.useRef(null);i.useEffect(()=>{ne.current=$},[$]),i.useEffect(()=>{fetch(`${Xe}/auth/status`,{credentials:"include"}).then(b=>b.json()).then(b=>A(b)).catch(()=>A({authenticated:!1,username:null})).finally(()=>X(!1))},[]),i.useEffect(()=>{h.length>0?localStorage.setItem(u,JSON.stringify(h)):localStorage.removeItem(u)},[h,u]),i.useEffect(()=>{const b=C=>{if(C.key===u)if(C.newValue===null)m([]);else try{const j=JSON.parse(C.newValue),k=new Set(h),U=j.filter(z=>!k.has(z));if(U.length>0){const z=new Set(U);l(T=>({...T,columns:T.columns.map(P=>({...P,cards:P.cards.filter(B=>!z.has(B.id))}))})),v(!0)}m(j)}catch{}};return window.addEventListener("storage",b),()=>window.removeEventListener("storage",b)},[u,h]),i.useEffect(()=>{if(!p)return;const b=C=>(C.preventDefault(),C.returnValue="You have unsaved changes. Are you sure you want to leave?",C.returnValue);return window.addEventListener("beforeunload",b),()=>window.removeEventListener("beforeunload",b)},[p]);const[De,w]=i.useState(null),[M,fe]=i.useState(null),[ce,he]=i.useState(!1),[ke,ee]=i.useState(void 0);i.useEffect(()=>{if(n)for(const b of a.columns){const C=b.cards.find(j=>j.id===n);if(C){w(C),he(!0);break}}},[]);const[de,xe]=i.useState(null),[$e,se]=i.useState(!1),[_e,ye]=i.useState(!1),[we,F]=i.useState(!1),Ce=i.useCallback(b=>{l(C=>b(C)),v(!0),D(!1)},[]),ge=i.useCallback(()=>{const b=encodeURIComponent(window.location.href);window.location.href=`${Xe}/auth/login?return_to=${b}`},[]),Ie=i.useCallback(async()=>{await fetch(`${Xe}/auth/logout`,{method:"POST",credentials:"include"}),A({authenticated:!1,username:null})},[]),oe=i.useCallback(async()=>{try{let b,C=null;try{const j=await fetch(`${Xe}/board/${t}`,{credentials:"include"});if(j.ok){const k=await j.json();b=k.board,C=k.headCommitSha}else throw new Error("API unavailable")}catch{b=(await ss(Object.assign({"../../../generated/kanban/house.js":()=>pt(()=>import("./house-DX4zlwYp.js").then(k=>k._),[]),"../../../generated/kanban/julias-gardens.js":()=>pt(()=>import("./julias-gardens-BZsU5GeJ.js").then(k=>k._),[]),"../../../generated/kanban/manifest.js":()=>pt(()=>import("./manifest-0AgvxBhP.js").then(k=>k._),[]),"../../../generated/kanban/roadmap.js":()=>pt(()=>import("./roadmap-COLay1Kb.js").then(k=>k._),[])}),`../../../generated/kanban/${t}.js`,6)).board}l(b),c.current=b,f(C),m([]),v(!1),te(!1),O(!1),pe.success("Board reloaded")}catch{pe.error("Failed to reload board")}},[t]),Ne=i.useCallback(async()=>{if(!(ne.current||!d))try{const b=await fetch(`${Xe}/board/${t}`,{credentials:"include"});if(!b.ok)return;const j=(await b.json()).headCommitSha;j&&j!==d&&(te(!0),pe("Board was updated externally",{id:"external-change",description:p?"You have unsaved changes that may conflict.":"Click reload to get the latest version.",action:{label:"Reload",onClick:oe},duration:1/0}))}catch{console.debug("External change check failed")}},[t,d,p,oe]);i.useEffect(()=>{let b=null;const C=()=>{b||(b=setInterval(Ne,15e3))},j=()=>{b&&(clearInterval(b),b=null)},k=()=>{document.visibilityState==="visible"?(Ne(),C()):j()};return document.visibilityState==="visible"&&C(),document.addEventListener("visibilitychange",k),()=>{j(),document.removeEventListener("visibilitychange",k)}},[Ne]);const Ae=i.useCallback(async()=>{if(!E.authenticated){pe.error("Not authenticated");return}if(!d){pe.error("Cannot save: missing commit reference. Please reload the page.");return}N(!0),D(!1);try{const b=await fetch(`${Xe}/save`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({board:a,boardId:t,headCommitSha:d,deletedCardIds:h})}),C=await b.json();if(b.ok&&C.success){v(!1),D(!0),m([]),C.newHeadSha&&f(C.newHeadSha);const j=new Date().toISOString();l(k=>{const U={...k,updatedAt:j};return c.current=U,U}),pe.success("Board saved! Changes will appear after precompile completes."),setTimeout(()=>D(!1),3e3)}else b.status===409?(O(!0),pe.error("Board was modified externally. Please reload to see changes.",{id:"save-conflict",action:{label:"Reload",onClick:oe},duration:1/0})):pe.error(C.message||C.error||"Save failed")}catch(b){console.error("Save error:",b),pe.error("Failed to save board")}finally{N(!1)}},[a,t,E.authenticated,d,h,oe]),dt=xs(pn(un,{activationConstraint:{distance:8}}),pn(cn,{coordinateGetter:Qo})),ut=b=>{for(const C of a.columns){const j=C.cards.find(k=>k.id===b);if(j)return j}return null},Ge=b=>a.columns.find(C=>C.cards.some(j=>j.id===b))||null,Re=b=>{const{active:C}=b,j=ut(C.id);y(j);const k=Ge(C.id);re.current=k?.id||null},Ue=i.useMemo(()=>kr(b=>{const{active:C,over:j}=b;if(!j)return;const k=C.id,U=j.id;i.startTransition(()=>{l(z=>{const T=z.columns.find(K=>K.cards.some(H=>H.id===k))||null,P=z.columns.find(K=>K.id===U)||z.columns.find(K=>K.cards.some(H=>H.id===U))||null;if(!T||!P||T.id===P.id)return z;const B=[...T.cards],ae=T.id===P.id?B:[...P.cards],q=B.findIndex(K=>K.id===k);if(q===-1)return z;const[J]=B.splice(q,1),ie=P.cards.findIndex(K=>K.id===U);return ie===-1?ae.push(J):ae.splice(ie,0,J),{...z,columns:z.columns.map(K=>K.id===T.id?{...K,cards:B}:K.id===P.id?{...K,cards:ae}:K)}})})},16),[]),Ke=b=>{const{active:C,over:j}=b,k=re.current;if(y(null),re.current=null,!j)return;const U=C.id,z=j.id;Ce(T=>{const P=T.columns.find(I=>I.cards.some(V=>V.id===U));if(!P)return T;const B=T.columns.find(I=>I.id===z)||T.columns.find(I=>I.cards.some(V=>V.id===z));if(!B)return T;const ae=P.id!==B.id,q=k&&k!==B.id;if((ae||U!==z)&&setTimeout(()=>{v(!0),D(!1)},0),P.id===B.id&&U===z&&!q)return T;const J=I=>{if(I.id!==U||!q)return I;const V=new Date().toISOString(),Y=I.history?.[I.history.length-1];return Y?.type==="column"&&Y?.columnId===B.id?{...I,updatedAt:V}:{...I,updatedAt:V,history:[...I.history||[],{type:"column",timestamp:V,columnId:B.id,columnTitle:B.title}]}};if(!ae){const I=P.cards.findIndex(Y=>Y.id===U),V=P.cards.findIndex(Y=>Y.id===z);return q?{...T,columns:T.columns.map(Y=>{if(Y.id!==P.id)return Y;const Be=I!==-1&&V!==-1&&I!==V?Nt(Y.cards,I,V):Y.cards;return{...Y,cards:Be.map(J)}})}:I===-1||V===-1||I===V?T:{...T,columns:T.columns.map(Y=>Y.id!==P.id?Y:{...Y,cards:Nt(Y.cards,I,V)})}}const ie=P.cards.filter(I=>I.id!==U),K=P.cards.find(I=>I.id===U);if(!K)return T;const H=B.cards.findIndex(I=>I.id===z),me=[...B.cards];return H===-1?me.push(K):me.splice(H,0,K),{...T,columns:T.columns.map(I=>I.id===P.id?{...I,cards:ie}:I.id===B.id?{...I,cards:me.map(J)}:I)}})},ft=b=>{fe(b),w(null),he(!0)},ht=(b,C)=>{w(b),fe(null),ee(C),he(!0)},_t=b=>{const C=new Date().toISOString();Ce(j=>{if(M){const k=j.columns.find(z=>z.id===M),U={...b,createdAt:C,updatedAt:C,history:k?[{type:"column",timestamp:C,columnId:k.id,columnTitle:k.title}]:[]};return{...j,columns:j.columns.map(z=>z.id===M?{...z,cards:[...z.cards,U]}:z)}}else{const k={...b,updatedAt:C};return{...j,columns:j.columns.map(U=>({...U,cards:U.cards.map(z=>z.id===b.id?k:z)}))}}})},Ut=b=>{m(C=>[...C,b]),Ce(C=>({...C,columns:C.columns.map(j=>({...j,cards:j.cards.filter(k=>k.id!==b)}))}))},Oe=b=>{xe(b),F(!1),se(!0)},Te=()=>{xe(null),F(!0),se(!0)},Fe=b=>{Ce(C=>we?{...C,columns:[...C.columns,{id:rn(),title:b.title,description:b.description,color:b.color,cards:[]}]}:de?{...C,columns:C.columns.map(j=>j.id===de?{...j,title:b.title,description:b.description,color:b.color}:j)}:C)},qe=b=>{const C=a.columns.find(j=>j.id===b);if(C){const j=C.cards.map(k=>k.id);m(k=>[...k,...j])}Ce(j=>({...j,columns:j.columns.filter(k=>k.id!==b)}))},Ee=()=>{l(c.current),m([]),v(!1),O(!1)},gt=async()=>{try{const b=new URL(window.location.href);b.search=`?board=${t}`,await navigator.clipboard.writeText(b.toString()),pe.success("Link copied to clipboard")}catch(b){console.error("Failed to copy URL:",b),pe.error("Failed to copy link")}},Kt=b=>{o(C=>{const j=new URLSearchParams(C);return j.set("board",b),j.delete("card"),j}),pe.success("Board created! It may take a moment to fully load.")},mt=de?a.columns.find(b=>b.id===de):null,Je=E.authenticated&&d&&p&&!R;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ma,{currentBoardId:t,currentBoardTitle:a.title,onCreateNew:()=>ye(!0),isAuthenticated:E.authenticated}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Drag cards between columns."}),p&&!R&&s.jsx("span",{className:"text-yellow-600 dark:text-yellow-400",children:"Unsaved changes"}),R&&s.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Conflict - reload required"}),x&&s.jsx("span",{className:"text-green-600 dark:text-green-400",children:"Saved!"}),E.authenticated&&s.jsxs("span",{className:"text-muted-foreground",children:["Logged in as ",s.jsx("span",{className:"font-medium",children:E.username})]})]}),s.jsxs("div",{className:"flex gap-2",children:[!_&&(E.authenticated?s.jsxs(s.Fragment,{children:[R?s.jsxs(G,{variant:"default",size:"sm",onClick:oe,children:[s.jsx(qr,{className:"w-4 h-4 mr-1"}),"Reload Board"]}):s.jsxs(G,{variant:p?"default":"outline-solid",size:"sm",onClick:Ae,disabled:S||!Je,title:d?void 0:"Cannot save: missing commit reference",children:[S?s.jsx(Et,{className:"w-4 h-4 mr-1 animate-spin"}):x?s.jsx(Kn,{className:"w-4 h-4 mr-1"}):s.jsx(Jr,{className:"w-4 h-4 mr-1"}),S?"Saving...":x?"Saved":"Save"]}),s.jsxs(G,{variant:"outline",size:"sm",onClick:Ie,children:[s.jsx(Qr,{className:"w-4 h-4 mr-1"}),"Logout"]})]}):s.jsxs(G,{variant:"outline",size:"sm",onClick:ge,children:[s.jsx(Zr,{className:"w-4 h-4 mr-1"}),"Login to Save"]})),s.jsxs(G,{variant:"outline",size:"sm",onClick:gt,children:[s.jsx(es,{className:"w-4 h-4 mr-1"}),"Copy Link"]}),s.jsxs(G,{variant:"outline",size:"sm",onClick:Ee,children:[s.jsx(ts,{className:"w-4 h-4 mr-1"}),"Reset"]})]})]}),s.jsxs(bo,{sensors:dt,collisionDetection:Zn,onDragStart:Re,onDragOver:Ue,onDragEnd:Ke,children:[s.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-4 items-start",children:[a.columns.map(b=>s.jsx(oa,{column:b,boardId:t,onAddCard:ft,onEditCard:ht,onEditColumn:Oe,onDeleteColumn:qe},b.id)),s.jsxs(G,{variant:"outline",className:"shrink-0 w-64 h-12 border-dashed self-start",onClick:Te,children:[s.jsx(kt,{className:"w-4 h-4 mr-1"}),"Add Column"]})]}),s.jsx(Po,{children:g&&s.jsx(Sr,{card:g,isDragOverlay:!0})})]}),s.jsx(da,{card:De,isOpen:ce,scrollTo:ke,onClose:()=>{he(!1),w(null),fe(null),ee(void 0)},onSave:_t,onDelete:De?Ut:void 0}),s.jsx(fa,{column:mt||null,isOpen:$e,onClose:()=>{se(!1),xe(null),F(!1)},onSave:Fe,onDelete:mt?qe:void 0}),s.jsx(va,{isOpen:_e,onClose:()=>ye(!1),onCreated:Kt})]})}export{Na as K,ss as _};
