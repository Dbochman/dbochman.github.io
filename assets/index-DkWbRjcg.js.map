{"version":3,"file":"index-DkWbRjcg.js","sources":["../../src/components/projects/incident-command-diagrams/index.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { Copy, Check } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent } from '@/components/ui/tabs';\nimport { ResponsiveTabsList } from '@/components/ui/responsive-tabs';\nimport { AnimatedMermaidDiagram, type AnimationNode } from './AnimatedMermaidDiagram';\n\nconst DIAGRAMS: Array<{\n  id: string;\n  title: string;\n  description: string;\n  code: string;\n  nodes: AnimationNode[];\n}> = [\n  {\n    id: 'incident-escalation',\n    title: 'Incident Escalation Process',\n    description:\n      'Route incidents based on severity and decide when to involve additional on-call support.',\n    code: `---\nconfig:\n  layout: fixed\n---\nflowchart TD\n  A[Incident reported] --> B[Triage and classify severity]\n  B --> C{High severity?}\n  C -->|Yes| D[Page On-Call]\n  D --> E[Incident Management Process ðŸ”—]\n  click E \"#incident-management\" \"Open Incident Management Process\"\n  C -->|No| F[Incident team investigates]\n  F --> G{Escalation needed?}\n  G -->|No| H[Continue response and resolve]\n  G -->|Yes, promote to high severity| D\n  class E jump;\n`,\n    nodes: [\n      // 0\n      { id: 'A', label: 'Incident reported', description: 'An incident has been identified and reported to the response team.' },\n      // 1\n      { id: 'B', label: 'Triage and classify severity', description: 'Assess the impact and urgency to determine severity level (P1-P4).' },\n      // 2: branches to D(3) or F(5)\n      { id: 'C', label: 'High severity?', type: 'decision', branches: [['High Severity', 3], ['Low Severity', 5]], description: 'Is this a P1/P2 incident affecting customers or critical systems?' },\n      // 3: link to service-owner-paging diagram\n      { id: 'D', label: 'Page On-Call', type: 'link', linkTo: 'service-owner-paging', description: 'Alert the on-call engineer immediately via PagerDuty or similar.' },\n      // 4: link to incident-management diagram\n      { id: 'E', label: 'Incident Management Process', type: 'link', linkTo: 'incident-management', description: 'Hand off to the formal incident management workflow.' },\n      // 5\n      { id: 'F', label: 'Incident team investigates', description: 'The current team continues investigating without escalation.' },\n      // 6: branches to D(3) or H(7)\n      { id: 'G', label: 'Escalation needed?', type: 'decision', branches: [['Escalate', 3], ['Continue', 7]], description: 'Has the situation worsened or stalled? Should we escalate?' },\n      // 7: link to incident-management diagram\n      { id: 'H', label: 'Continue response and resolve', type: 'link', linkTo: 'incident-management', description: 'Proceed with mitigation and resolution without further escalation.' },\n    ],\n  },\n  {\n    id: 'incident-management',\n    title: 'Incident Management Process',\n    description:\n      'Establish roles, keep stakeholders informed, and close the loop on resolution.',\n    code: `---\nconfig:\n  layout: fixed\n---\nflowchart TD\n  A[On-Call Paged] --> B[Triage and Assess Severity]\n  B --> C{Need additional responders?}\n  C -->|Yes| D[Page Additional On-Call ðŸ”—]\n  C -->|No| E[Proceed with current responders]\n  D --> F[Investigate and Mitigate Issues]\n  E --> F\n  F --> G[Monitor progress and share updates]\n  G --> H{Customer impact?}\n  H -->|Yes| I[Post updates to status page]\n  H -->|No| J[Issue Mitigated]\n  I --> J\n  J --> K{Confirm stability}\n  K -->|Yes| L[Resolve StatusPage Incident]\n  K -->|No| M[Continue mitigation]\n  M --> F\n  L --> N[Incident Resolution]\n  click D \"#service-owner-paging\" \"Open Service Owner Paging Path\"\n  class D jump;\n`,\n    nodes: [\n      // 0\n      { id: 'A', label: 'On-Call Paged', description: 'The on-call engineer has been alerted and is responding.' },\n      // 1\n      { id: 'B', label: 'Triage and Assess Severity', description: 'Quickly assess what\\'s happening and confirm severity level.' },\n      // 2: branches to D(3) or E(4)\n      { id: 'C', label: 'Need additional responders?', type: 'decision', branches: [['Page More', 3], ['Proceed Solo', 4]], description: 'Can you handle this alone, or do you need specialists?' },\n      // 3: link to service-owner-paging diagram (continueAt skips E to converge at F)\n      { id: 'D', label: 'Page Additional On-Call', type: 'link', linkTo: 'service-owner-paging', continueAt: 5, description: 'Bring in service owners or specialists who can help.' },\n      // 4\n      { id: 'E', label: 'Proceed with current responders', description: 'Continue with the current team.' },\n      // 5\n      { id: 'F', label: 'Investigate and Mitigate Issues', description: 'Dig into root cause while working on mitigation.' },\n      // 6\n      { id: 'G', label: 'Monitor progress and share updates', description: 'Keep stakeholders informed with regular updates.' },\n      // 7: branches to I(8) or J(9)\n      { id: 'H', label: 'Customer impact?', type: 'decision', branches: [['Yes', 8], ['No', 9]], description: 'Are customers affected by this incident?' },\n      // 8: link to statuspage-update tool\n      { id: 'I', label: 'Post updates to status page', type: 'link', linkTo: '/projects/statuspage-update', description: 'Communicate externally via status page.' },\n      // 9\n      { id: 'J', label: 'Issue Mitigated', description: 'The immediate problem has been addressed.' },\n      // 10: branches to L(11) or back to F(5) for retry\n      { id: 'K', label: 'Confirm stability', type: 'decision', branches: [['Stable', 11], ['Not Stable', 5]], description: 'Are we confident the fix is holding?' },\n      // 11\n      { id: 'L', label: 'Resolve StatusPage Incident', description: 'Mark the external incident as resolved.' },\n      // 12 (M is a loop-back node only reachable via \"Not Stable\" branch to F, not part of main flow)\n      { id: 'N', label: 'Incident Resolution', description: 'Close out the internal incident ticket.' },\n    ],\n  },\n  {\n    id: 'service-owner-paging',\n    title: 'Service Owner Paging Path',\n    description:\n      'Find the right on-call responder using the service catalog and escalation paths.',\n    code: `---\nconfig:\n  layout: fixed\n---\nflowchart TD\n  A[Issue identified in a specific service] --> B[Search service catalog for owner info]\n  B -->|On-call link found| C[Page On-Call]\n  B -->|No owner info found| D[Search on-call tool for service]\n  D -->|Service found| E[Page On-Call]\n  D -->|Can't find service| F[Check Slack/Teams/Email]\n  F --> G{Service Owner Found}\n  G -->|Page On-Call| H[Page On-Call]\n  G -->|No On-Call Found| J[Escalate within your team]\n`,\n    nodes: [\n      { id: 'A', label: 'Issue identified in a specific service', description: 'You\\'ve identified which service is causing the problem.' },\n      { id: 'B', label: 'Search service catalog for owner info', description: 'Check your service catalog/registry for ownership info.' },\n      { id: 'C', label: 'Page On-Call', description: 'Use the catalog link to page the service owner.' },\n      { id: 'D', label: 'Search on-call tool for service', description: 'Search PagerDuty/OpsGenie directly for the service.' },\n      { id: 'E', label: 'Page On-Call', description: 'Found it - page the service owner.' },\n      { id: 'F', label: 'Check Slack/Teams/Email', description: 'Try communication channels to find the owner.' },\n      // 6: branches to H(7) or J(8)\n      { id: 'G', label: 'Service Owner Found', type: 'decision', branches: [['Found', 7], ['Not Found', 8]], description: 'Were you able to locate someone responsible?' },\n      { id: 'H', label: 'Page On-Call', description: 'Successfully located owner - page them.' },\n      { id: 'J', label: 'Escalate within your team', description: 'No owner found - escalate to your leadership.' },\n    ],\n  },\n];\n\nconst DIAGRAM_TABS = DIAGRAMS.map((d) => ({ value: d.id, label: d.title }));\n\ninterface DiagramCardProps {\n  title: string;\n  description: string;\n  code: string;\n  nodes: AnimationNode[];\n  onLinkClick?: (linkTo: string) => void;\n}\n\nfunction DiagramCard({ title, description, code, nodes, onLinkClick }: DiagramCardProps) {\n  const [copied, setCopied] = useState(false);\n\n  const handleCopy = async () => {\n    await navigator.clipboard.writeText(code.trim());\n    setCopied(true);\n    setTimeout(() => setCopied(false), 2000);\n  };\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle as=\"h2\" className=\"text-xl\">\n          {title}\n        </CardTitle>\n        <CardDescription>{description}</CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <AnimatedMermaidDiagram code={code} nodes={nodes} speed={1500} onLinkClick={onLinkClick} />\n        <details className=\"rounded-md border border-dashed px-4 py-3 text-sm\">\n          <summary className=\"cursor-pointer text-muted-foreground\">\n            View Mermaid source\n          </summary>\n          <div className=\"mt-3 space-y-3\">\n            <Button variant=\"outline\" size=\"sm\" onClick={handleCopy} className=\"gap-2\">\n              {copied ? <Check className=\"h-4 w-4\" /> : <Copy className=\"h-4 w-4\" />}\n              {copied ? 'Copied' : 'Copy Mermaid'}\n            </Button>\n            <pre className=\"whitespace-pre-wrap text-xs text-muted-foreground\">\n              {code.trim()}\n            </pre>\n          </div>\n        </details>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function IncidentCommandDiagrams() {\n  const [activeTab, setActiveTab] = useState(DIAGRAMS[0].id);\n\n  useEffect(() => {\n    const updateFromHash = () => {\n      const hash = window.location.hash.replace('#', '');\n      if (DIAGRAMS.some((diagram) => diagram.id === hash)) {\n        setActiveTab(hash);\n      }\n    };\n\n    updateFromHash();\n    window.addEventListener('hashchange', updateFromHash);\n\n    return () => window.removeEventListener('hashchange', updateFromHash);\n  }, []);\n\n  const handleTabChange = (value: string) => {\n    setActiveTab(value);\n    if (typeof window !== 'undefined') {\n      window.history.replaceState(null, '', `#${value}`);\n    }\n  };\n\n  const handleLinkClick = (linkTo: string) => {\n    // External links start with / - open in new tab\n    if (linkTo.startsWith('/')) {\n      window.open(linkTo, '_blank');\n    } else {\n      // Internal tab links\n      handleTabChange(linkTo);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <p className=\"text-sm text-muted-foreground\">\n        Three incident command flowcharts that you can reuse, edit, and export as Mermaid.\n        Use the tabs to switch views and copy the underlying diagram code.\n      </p>\n      <Tabs value={activeTab} onValueChange={handleTabChange} className=\"space-y-4\">\n        <ResponsiveTabsList\n          items={DIAGRAM_TABS}\n          value={activeTab}\n          onValueChange={handleTabChange}\n          tabsListClassName=\"h-auto w-fit max-w-full flex-wrap justify-start gap-1 rounded-lg bg-zinc-200 p-1 text-muted-foreground dark:bg-zinc-800\"\n          triggerClassName=\"rounded-md px-3 py-1.5 text-xs data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-xs sm:text-sm\"\n        />\n        {DIAGRAMS.map((diagram) => (\n          <TabsContent key={diagram.id} value={diagram.id} id={diagram.id}>\n            <DiagramCard\n              title={diagram.title}\n              description={diagram.description}\n              code={diagram.code}\n              nodes={diagram.nodes}\n              onLinkClick={handleLinkClick}\n            />\n          </TabsContent>\n        ))}\n      </Tabs>\n    </div>\n  );\n}\n"],"names":["DIAGRAMS","DIAGRAM_TABS","d","DiagramCard","title","description","code","nodes","onLinkClick","copied","setCopied","useState","handleCopy","Card","jsxs","CardHeader","jsx","CardTitle","CardDescription","CardContent","AnimatedMermaidDiagram","Button","Check","Copy","IncidentCommandDiagrams","activeTab","setActiveTab","useEffect","updateFromHash","hash","diagram","handleTabChange","value","handleLinkClick","linkTo","Tabs","ResponsiveTabsList","TabsContent"],"mappings":"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"}